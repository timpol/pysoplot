<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>pysoplot package &mdash; pysoplot 0.1.1 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> pysoplot
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">Getting getting</a></li>
<li class="toctree-l1"><a class="reference internal" href="age_calcs.html">Age calculation routines</a></li>
<li class="toctree-l1"><a class="reference internal" href="regression.html">Linear regression algorithms</a></li>
<li class="toctree-l1"><a class="reference internal" href="wtd_average.html">Weighted average algorithms</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html">API</a></li>
<li class="toctree-l1"><a class="reference internal" href="references.html">References</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">pysoplot</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a></li>
      <li class="breadcrumb-item active">pysoplot package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/pysoplot.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="pysoplot-package">
<h1>pysoplot package<a class="headerlink" href="#pysoplot-package" title="Permalink to this heading"></a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this heading"></a></h2>
</section>
<section id="module-pysoplot.cfg">
<span id="pysoplot-cfg-module"></span><h2>pysoplot.cfg module<a class="headerlink" href="#module-pysoplot.cfg" title="Permalink to this heading"></a></h2>
<p>Package-wide settings and constants.</p>
<dl class="py data">
<dt class="sig sig-object py" id="pysoplot.cfg.U">
<span class="sig-prename descclassname"><span class="pre">pysoplot.cfg.</span></span><span class="sig-name descname"><span class="pre">U</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">137.818</span></em><a class="headerlink" href="#pysoplot.cfg.U" title="Permalink to this definition"></a></dt>
<dd><p>Modern natural 238U/235U ratio. Default <a class="reference internal" href="references.html#hiess2012" id="id1"><span>[HIESS2012]</span></a>.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="pysoplot.cfg.axis_labels_kw">
<span class="sig-prename descclassname"><span class="pre">pysoplot.cfg.</span></span><span class="sig-name descname"><span class="pre">axis_labels_kw</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'color':</span> <span class="pre">'black',</span> <span class="pre">'fontsize':</span> <span class="pre">10}</span></em><a class="headerlink" href="#pysoplot.cfg.axis_labels_kw" title="Permalink to this definition"></a></dt>
<dd><p>Axis labels key-word arguments.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="pysoplot.cfg.conc_age_ellipse_kw">
<span class="sig-prename descclassname"><span class="pre">pysoplot.cfg.</span></span><span class="sig-name descname"><span class="pre">conc_age_ellipse_kw</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'alpha':</span> <span class="pre">1.0,</span> <span class="pre">'edgecolor':</span> <span class="pre">'black',</span> <span class="pre">'facecolor':</span> <span class="pre">'white',</span> <span class="pre">'linewidth':</span> <span class="pre">0.5,</span> <span class="pre">'zorder':</span> <span class="pre">10}</span></em><a class="headerlink" href="#pysoplot.cfg.conc_age_ellipse_kw" title="Permalink to this definition"></a></dt>
<dd><p>Concordia age ellipse marker key-word arguments.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="pysoplot.cfg.conc_env_kw">
<span class="sig-prename descclassname"><span class="pre">pysoplot.cfg.</span></span><span class="sig-name descname"><span class="pre">conc_env_kw</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'alpha':</span> <span class="pre">1.0,</span> <span class="pre">'edgecolor':</span> <span class="pre">'none',</span> <span class="pre">'facecolor':</span> <span class="pre">'white',</span> <span class="pre">'linestyle':</span> <span class="pre">'-',</span> <span class="pre">'linewidth':</span> <span class="pre">0.0,</span> <span class="pre">'zorder':</span> <span class="pre">8}</span></em><a class="headerlink" href="#pysoplot.cfg.conc_env_kw" title="Permalink to this definition"></a></dt>
<dd><p>Concordia uncertainty envelope fill key-word arguments.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="pysoplot.cfg.conc_env_line_kw">
<span class="sig-prename descclassname"><span class="pre">pysoplot.cfg.</span></span><span class="sig-name descname"><span class="pre">conc_env_line_kw</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'alpha':</span> <span class="pre">1.0,</span> <span class="pre">'color':</span> <span class="pre">'black',</span> <span class="pre">'linestyle':</span> <span class="pre">'--',</span> <span class="pre">'linewidth':</span> <span class="pre">1.0,</span> <span class="pre">'zorder':</span> <span class="pre">8}</span></em><a class="headerlink" href="#pysoplot.cfg.conc_env_line_kw" title="Permalink to this definition"></a></dt>
<dd><p>Concordia envelope line key-word arguments.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="pysoplot.cfg.conc_intercept_ellipse_kw">
<span class="sig-prename descclassname"><span class="pre">pysoplot.cfg.</span></span><span class="sig-name descname"><span class="pre">conc_intercept_ellipse_kw</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'alpha':</span> <span class="pre">0.6,</span> <span class="pre">'edgecolor':</span> <span class="pre">'black',</span> <span class="pre">'facecolor':</span> <span class="pre">'lightgrey',</span> <span class="pre">'linewidth':</span> <span class="pre">1.0,</span> <span class="pre">'zorder':</span> <span class="pre">30}</span></em><a class="headerlink" href="#pysoplot.cfg.conc_intercept_ellipse_kw" title="Permalink to this definition"></a></dt>
<dd><p>Concordia intercept ellipse key-word arguments.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="pysoplot.cfg.conc_intercept_markers_kw">
<span class="sig-prename descclassname"><span class="pre">pysoplot.cfg.</span></span><span class="sig-name descname"><span class="pre">conc_intercept_markers_kw</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'alpha':</span> <span class="pre">0.5,</span> <span class="pre">'linewidth':</span> <span class="pre">0,</span> <span class="pre">'marker':</span> <span class="pre">',',</span> <span class="pre">'markeredgecolor':</span> <span class="pre">'none',</span> <span class="pre">'markerfacecolor':</span> <span class="pre">'black',</span> <span class="pre">'markersize':</span> <span class="pre">4,</span> <span class="pre">'zorder':</span> <span class="pre">30}</span></em><a class="headerlink" href="#pysoplot.cfg.conc_intercept_markers_kw" title="Permalink to this definition"></a></dt>
<dd><p>Concordia intercept markers key-word arguments.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="pysoplot.cfg.conc_line_kw">
<span class="sig-prename descclassname"><span class="pre">pysoplot.cfg.</span></span><span class="sig-name descname"><span class="pre">conc_line_kw</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'alpha':</span> <span class="pre">1.0,</span> <span class="pre">'color':</span> <span class="pre">'black',</span> <span class="pre">'linestyle':</span> <span class="pre">'-',</span> <span class="pre">'linewidth':</span> <span class="pre">0.8,</span> <span class="pre">'zorder':</span> <span class="pre">9}</span></em><a class="headerlink" href="#pysoplot.cfg.conc_line_kw" title="Permalink to this definition"></a></dt>
<dd><p>Concordia line key-word arguments.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="pysoplot.cfg.conc_markers_kw">
<span class="sig-prename descclassname"><span class="pre">pysoplot.cfg.</span></span><span class="sig-name descname"><span class="pre">conc_markers_kw</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'alpha':</span> <span class="pre">1.0,</span> <span class="pre">'linewidth':</span> <span class="pre">0,</span> <span class="pre">'marker':</span> <span class="pre">'o',</span> <span class="pre">'markeredgecolor':</span> <span class="pre">'black',</span> <span class="pre">'markerfacecolor':</span> <span class="pre">'white',</span> <span class="pre">'markersize':</span> <span class="pre">4,</span> <span class="pre">'zorder':</span> <span class="pre">10}</span></em><a class="headerlink" href="#pysoplot.cfg.conc_markers_kw" title="Permalink to this definition"></a></dt>
<dd><p>Concordia age markers key-word arguments.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="pysoplot.cfg.conc_text_kw">
<span class="sig-prename descclassname"><span class="pre">pysoplot.cfg.</span></span><span class="sig-name descname"><span class="pre">conc_text_kw</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'annotation_clip':</span> <span class="pre">False,</span> <span class="pre">'clip_on':</span> <span class="pre">True,</span> <span class="pre">'color':</span> <span class="pre">'black',</span> <span class="pre">'fontsize':</span> <span class="pre">8,</span> <span class="pre">'horizontalalignment':</span> <span class="pre">'left',</span> <span class="pre">'textcoords':</span> <span class="pre">'offset</span> <span class="pre">points',</span> <span class="pre">'verticalalignment':</span> <span class="pre">'center',</span> <span class="pre">'xytext':</span> <span class="pre">(3,</span> <span class="pre">3),</span> <span class="pre">'zorder':</span> <span class="pre">11}</span></em><a class="headerlink" href="#pysoplot.cfg.conc_text_kw" title="Permalink to this definition"></a></dt>
<dd><p>Concordia marker labels key-word arguments.
Caution: Be careful changing the annotation_clip and clip_on settings.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="pysoplot.cfg.dp_ellipse_kw">
<span class="sig-prename descclassname"><span class="pre">pysoplot.cfg.</span></span><span class="sig-name descname"><span class="pre">dp_ellipse_kw</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'alpha':</span> <span class="pre">1.0,</span> <span class="pre">'edgecolor':</span> <span class="pre">'black',</span> <span class="pre">'facecolor':</span> <span class="pre">'white',</span> <span class="pre">'linewidth':</span> <span class="pre">0.8,</span> <span class="pre">'zorder':</span> <span class="pre">40}</span></em><a class="headerlink" href="#pysoplot.cfg.dp_ellipse_kw" title="Permalink to this definition"></a></dt>
<dd><p>Data point confidence ellipse key-word arguments.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="pysoplot.cfg.dp_label_kw">
<span class="sig-prename descclassname"><span class="pre">pysoplot.cfg.</span></span><span class="sig-name descname"><span class="pre">dp_label_kw</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'color':</span> <span class="pre">'black',</span> <span class="pre">'fontsize':</span> <span class="pre">8,</span> <span class="pre">'horizontalalignment':</span> <span class="pre">'center',</span> <span class="pre">'textcoords':</span> <span class="pre">'offset</span> <span class="pre">points',</span> <span class="pre">'verticalalignment':</span> <span class="pre">'center',</span> <span class="pre">'xytext':</span> <span class="pre">(10,</span> <span class="pre">0),</span> <span class="pre">'zorder':</span> <span class="pre">40}</span></em><a class="headerlink" href="#pysoplot.cfg.dp_label_kw" title="Permalink to this definition"></a></dt>
<dd><p>Data point confidence ellipse key-word arguments.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="pysoplot.cfg.fig_kw">
<span class="sig-prename descclassname"><span class="pre">pysoplot.cfg.</span></span><span class="sig-name descname"><span class="pre">fig_kw</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'dpi':</span> <span class="pre">300,</span> <span class="pre">'facecolor':</span> <span class="pre">'white',</span> <span class="pre">'figsize':</span> <span class="pre">(4.72,</span> <span class="pre">4.012),</span> <span class="pre">'tight_layout':</span> <span class="pre">True}</span></em><a class="headerlink" href="#pysoplot.cfg.fig_kw" title="Permalink to this definition"></a></dt>
<dd><p>Figure key-word arguments.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="pysoplot.cfg.gridlines_kw">
<span class="sig-prename descclassname"><span class="pre">pysoplot.cfg.</span></span><span class="sig-name descname"><span class="pre">gridlines_kw</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'alpha':</span> <span class="pre">1.0,</span> <span class="pre">'color':</span> <span class="pre">'black',</span> <span class="pre">'linestyle':</span> <span class="pre">':',</span> <span class="pre">'linewidth':</span> <span class="pre">0.5}</span></em><a class="headerlink" href="#pysoplot.cfg.gridlines_kw" title="Permalink to this definition"></a></dt>
<dd><p>Figure gridline key-word arguments.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="pysoplot.cfg.h">
<span class="sig-prename descclassname"><span class="pre">pysoplot.cfg.</span></span><span class="sig-name descname"><span class="pre">h</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1.4</span></em><a class="headerlink" href="#pysoplot.cfg.h" title="Permalink to this definition"></a></dt>
<dd><p>Spine h value (see <span id="id2">[Powell2020]</span>).</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="pysoplot.cfg.hist_bars_kw">
<span class="sig-prename descclassname"><span class="pre">pysoplot.cfg.</span></span><span class="sig-name descname"><span class="pre">hist_bars_kw</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'alpha':</span> <span class="pre">0.75,</span> <span class="pre">'edgecolor':</span> <span class="pre">'red',</span> <span class="pre">'facecolor':</span> <span class="pre">'green',</span> <span class="pre">'histtype':</span> <span class="pre">'step',</span> <span class="pre">'linewidth':</span> <span class="pre">0.75}</span></em><a class="headerlink" href="#pysoplot.cfg.hist_bars_kw" title="Permalink to this definition"></a></dt>
<dd><p>Histogram bar key-word arguments.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="pysoplot.cfg.hist_fig_kw">
<span class="sig-prename descclassname"><span class="pre">pysoplot.cfg.</span></span><span class="sig-name descname"><span class="pre">hist_fig_kw</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'dpi':</span> <span class="pre">300,</span> <span class="pre">'facecolor':</span> <span class="pre">'white',</span> <span class="pre">'figsize':</span> <span class="pre">(4.72,</span> <span class="pre">4.012),</span> <span class="pre">'tight_layout':</span> <span class="pre">True}</span></em><a class="headerlink" href="#pysoplot.cfg.hist_fig_kw" title="Permalink to this definition"></a></dt>
<dd><p>Histogram figure key-word arguments.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="pysoplot.cfg.lam226">
<span class="sig-prename descclassname"><span class="pre">pysoplot.cfg.</span></span><span class="sig-name descname"><span class="pre">lam226</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">433.2169878499658</span></em><a class="headerlink" href="#pysoplot.cfg.lam226" title="Permalink to this definition"></a></dt>
<dd><p>226Ra decay constant [Ma^-1]</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="pysoplot.cfg.lam230">
<span class="sig-prename descclassname"><span class="pre">pysoplot.cfg.</span></span><span class="sig-name descname"><span class="pre">lam230</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">9.170554357535263</span></em><a class="headerlink" href="#pysoplot.cfg.lam230" title="Permalink to this definition"></a></dt>
<dd><p>230Th decay constant [Ma^-1]. Default <a class="reference internal" href="references.html#cheng2013" id="id3"><span>[CHENG2013]</span></a>.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="pysoplot.cfg.lam231">
<span class="sig-prename descclassname"><span class="pre">pysoplot.cfg.</span></span><span class="sig-name descname"><span class="pre">lam231</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">21.15511004303205</span></em><a class="headerlink" href="#pysoplot.cfg.lam231" title="Permalink to this definition"></a></dt>
<dd><p>231Pa decay constant [Ma^-1]. Default <a class="reference internal" href="references.html#robert1969" id="id4"><span>[ROBERT1969]</span></a>.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="pysoplot.cfg.lam232">
<span class="sig-prename descclassname"><span class="pre">pysoplot.cfg.</span></span><span class="sig-name descname"><span class="pre">lam232</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">4.947517348750502e-05</span></em><a class="headerlink" href="#pysoplot.cfg.lam232" title="Permalink to this definition"></a></dt>
<dd><p>232Th decay constant [Ma^-1] (default <a class="reference internal" href="references.html#holden1990" id="id5"><span>[HOLDEN1990]</span></a>)</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="pysoplot.cfg.lam234">
<span class="sig-prename descclassname"><span class="pre">pysoplot.cfg.</span></span><span class="sig-name descname"><span class="pre">lam234</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">2.822030700105632</span></em><a class="headerlink" href="#pysoplot.cfg.lam234" title="Permalink to this definition"></a></dt>
<dd><p>234U decay constant [Ma^-1]. Default <a class="reference internal" href="references.html#cheng2013" id="id6"><span>[CHENG2013]</span></a>.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="pysoplot.cfg.lam235">
<span class="sig-prename descclassname"><span class="pre">pysoplot.cfg.</span></span><span class="sig-name descname"><span class="pre">lam235</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.000984849860843</span></em><a class="headerlink" href="#pysoplot.cfg.lam235" title="Permalink to this definition"></a></dt>
<dd><p>235U decay constant [Ma^-1]. Default <a class="reference internal" href="references.html#jaffey1971" id="id7"><span>[JAFFEY1971]</span></a>.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="pysoplot.cfg.lam238">
<span class="sig-prename descclassname"><span class="pre">pysoplot.cfg.</span></span><span class="sig-name descname"><span class="pre">lam238</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.000155125479614</span></em><a class="headerlink" href="#pysoplot.cfg.lam238" title="Permalink to this definition"></a></dt>
<dd><p>238U decay constant [Ma^-1]. Default <a class="reference internal" href="references.html#jaffey1971" id="id8"><span>[JAFFEY1971]</span></a>.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="pysoplot.cfg.major_ticks_kw">
<span class="sig-prename descclassname"><span class="pre">pysoplot.cfg.</span></span><span class="sig-name descname"><span class="pre">major_ticks_kw</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'color':</span> <span class="pre">'black',</span> <span class="pre">'direction':</span> <span class="pre">'in',</span> <span class="pre">'length':</span> <span class="pre">4,</span> <span class="pre">'width':</span> <span class="pre">0.5,</span> <span class="pre">'zorder':</span> <span class="pre">100}</span></em><a class="headerlink" href="#pysoplot.cfg.major_ticks_kw" title="Permalink to this definition"></a></dt>
<dd><p>Major axis tick key-word arguments.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="pysoplot.cfg.minor_ticks_kw">
<span class="sig-prename descclassname"><span class="pre">pysoplot.cfg.</span></span><span class="sig-name descname"><span class="pre">minor_ticks_kw</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'color':</span> <span class="pre">'black',</span> <span class="pre">'direction':</span> <span class="pre">'in',</span> <span class="pre">'length':</span> <span class="pre">2,</span> <span class="pre">'width':</span> <span class="pre">0.5,</span> <span class="pre">'zorder':</span> <span class="pre">100}</span></em><a class="headerlink" href="#pysoplot.cfg.minor_ticks_kw" title="Permalink to this definition"></a></dt>
<dd><p>Minor axis tick key-word arguments.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="pysoplot.cfg.mswd_ci_thresholds">
<span class="sig-prename descclassname"><span class="pre">pysoplot.cfg.</span></span><span class="sig-name descname"><span class="pre">mswd_ci_thresholds</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">[0.85,</span> <span class="pre">0.95]</span></em><a class="headerlink" href="#pysoplot.cfg.mswd_ci_thresholds" title="Permalink to this definition"></a></dt>
<dd><p>MSWD one-sided confidence interval thresholds for classical
regression fits. First element is the model 1 –&gt; 1x threshold, second element
is the model 1x –&gt; 2/3 threshold.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="pysoplot.cfg.mswd_wav_ci_thresholds">
<span class="sig-prename descclassname"><span class="pre">pysoplot.cfg.</span></span><span class="sig-name descname"><span class="pre">mswd_wav_ci_thresholds</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">[0.85,</span> <span class="pre">0.95]</span></em><a class="headerlink" href="#pysoplot.cfg.mswd_wav_ci_thresholds" title="Permalink to this definition"></a></dt>
<dd><p>MSWD one-sided confidence interval thresholds for classical wtd. averages.
First element is analytical –&gt; analytical + observed scatter threshold.
Second element is not yet used. Equivalent Isoplot default for first
element is 0.70.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="pysoplot.cfg.pb76_line_kw">
<span class="sig-prename descclassname"><span class="pre">pysoplot.cfg.</span></span><span class="sig-name descname"><span class="pre">pb76_line_kw</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'alpha':</span> <span class="pre">0.5,</span> <span class="pre">'color':</span> <span class="pre">'red',</span> <span class="pre">'linestyle':</span> <span class="pre">'--',</span> <span class="pre">'linewidth':</span> <span class="pre">1.0,</span> <span class="pre">'zorder':</span> <span class="pre">10}</span></em><a class="headerlink" href="#pysoplot.cfg.pb76_line_kw" title="Permalink to this definition"></a></dt>
<dd><p>Common 207Pb/206Pb projection line key-word arguments.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="pysoplot.cfg.renv_kw">
<span class="sig-prename descclassname"><span class="pre">pysoplot.cfg.</span></span><span class="sig-name descname"><span class="pre">renv_kw</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'alpha':</span> <span class="pre">0.3,</span> <span class="pre">'edgecolor':</span> <span class="pre">'none',</span> <span class="pre">'facecolor':</span> <span class="pre">'none',</span> <span class="pre">'linewidth':</span> <span class="pre">0.0,</span> <span class="pre">'zorder':</span> <span class="pre">20}</span></em><a class="headerlink" href="#pysoplot.cfg.renv_kw" title="Permalink to this definition"></a></dt>
<dd><p>Regression envelope key-word arguments.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="pysoplot.cfg.renv_line_kw">
<span class="sig-prename descclassname"><span class="pre">pysoplot.cfg.</span></span><span class="sig-name descname"><span class="pre">renv_line_kw</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'alpha':</span> <span class="pre">1.0,</span> <span class="pre">'color':</span> <span class="pre">'red',</span> <span class="pre">'linestyle':</span> <span class="pre">'--',</span> <span class="pre">'linewidth':</span> <span class="pre">0.8,</span> <span class="pre">'zorder':</span> <span class="pre">20}</span></em><a class="headerlink" href="#pysoplot.cfg.renv_line_kw" title="Permalink to this definition"></a></dt>
<dd><p>Regression envelope line key-word arguments.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="pysoplot.cfg.rline_kw">
<span class="sig-prename descclassname"><span class="pre">pysoplot.cfg.</span></span><span class="sig-name descname"><span class="pre">rline_kw</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'alpha':</span> <span class="pre">1.0,</span> <span class="pre">'color':</span> <span class="pre">'red',</span> <span class="pre">'linestyle':</span> <span class="pre">'-',</span> <span class="pre">'linewidth':</span> <span class="pre">0.75,</span> <span class="pre">'zorder':</span> <span class="pre">21}</span></em><a class="headerlink" href="#pysoplot.cfg.rline_kw" title="Permalink to this definition"></a></dt>
<dd><p>Regression line key-word arguments.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="pysoplot.cfg.rng">
<span class="sig-prename descclassname"><span class="pre">pysoplot.cfg.</span></span><span class="sig-name descname"><span class="pre">rng</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">Generator(PCG64)</span> <span class="pre">at</span> <span class="pre">0x1101151C0</span></em><a class="headerlink" href="#pysoplot.cfg.rng" title="Permalink to this definition"></a></dt>
<dd><p>Random number generator used across all modules.
Allows for reproducible Monte Carlo simulations results.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.Generator</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="pysoplot.cfg.s226">
<span class="sig-prename descclassname"><span class="pre">pysoplot.cfg.</span></span><span class="sig-name descname"><span class="pre">s226</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1.8953243218436007</span></em><a class="headerlink" href="#pysoplot.cfg.s226" title="Permalink to this definition"></a></dt>
<dd><p>226Ra decay constant 1 sigma uncertainty [Ma^-1]</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="pysoplot.cfg.s230">
<span class="sig-prename descclassname"><span class="pre">pysoplot.cfg.</span></span><span class="sig-name descname"><span class="pre">s230</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.006673111897550267</span></em><a class="headerlink" href="#pysoplot.cfg.s230" title="Permalink to this definition"></a></dt>
<dd><p>230Th decay constant 1 sigma uncertainty [Ma^-1]. Default <a class="reference internal" href="references.html#cheng2013" id="id9"><span>[CHENG2013]</span></a>.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="pysoplot.cfg.s231">
<span class="sig-prename descclassname"><span class="pre">pysoplot.cfg.</span></span><span class="sig-name descname"><span class="pre">s231</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.07102280191465059</span></em><a class="headerlink" href="#pysoplot.cfg.s231" title="Permalink to this definition"></a></dt>
<dd><p>231Pa decay constant 1 sigma uncertainty [Ma^-1]. Default <a class="reference internal" href="references.html#robert1969" id="id10"><span>[ROBERT1969]</span></a>.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="pysoplot.cfg.s232">
<span class="sig-prename descclassname"><span class="pre">pysoplot.cfg.</span></span><span class="sig-name descname"><span class="pre">s232</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">3.531422306388949e-07</span></em><a class="headerlink" href="#pysoplot.cfg.s232" title="Permalink to this definition"></a></dt>
<dd><p>232Th decay constant 1 sigma uncertainty [Ma^-1]. Default <a class="reference internal" href="references.html#holden1990" id="id11"><span>[HOLDEN1990]</span></a>.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="pysoplot.cfg.s234">
<span class="sig-prename descclassname"><span class="pre">pysoplot.cfg.</span></span><span class="sig-name descname"><span class="pre">s234</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.001493624261109568</span></em><a class="headerlink" href="#pysoplot.cfg.s234" title="Permalink to this definition"></a></dt>
<dd><p>234U decay constant 1 sigma uncertainty [Ma^-1]. Default <a class="reference internal" href="references.html#cheng2013" id="id12"><span>[CHENG2013]</span></a>.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="pysoplot.cfg.s235">
<span class="sig-prename descclassname"><span class="pre">pysoplot.cfg.</span></span><span class="sig-name descname"><span class="pre">s235</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">6.716698160081028e-07</span></em><a class="headerlink" href="#pysoplot.cfg.s235" title="Permalink to this definition"></a></dt>
<dd><p>235U decay constant 1 sigma uncertainty [Ma^-1]. Default <a class="reference internal" href="references.html#jaffey1971" id="id13"><span>[JAFFEY1971]</span></a>.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="pysoplot.cfg.s238">
<span class="sig-prename descclassname"><span class="pre">pysoplot.cfg.</span></span><span class="sig-name descname"><span class="pre">s238</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">8.332053601458737e-08</span></em><a class="headerlink" href="#pysoplot.cfg.s238" title="Permalink to this definition"></a></dt>
<dd><p>238U decay constant 1 sigma uncertainty [Ma^-1]. Default <a class="reference internal" href="references.html#jaffey1971" id="id14"><span>[JAFFEY1971]</span></a>.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="pysoplot.cfg.sU">
<span class="sig-prename descclassname"><span class="pre">pysoplot.cfg.</span></span><span class="sig-name descname"><span class="pre">sU</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.0225</span></em><a class="headerlink" href="#pysoplot.cfg.sU" title="Permalink to this definition"></a></dt>
<dd><p>Modern natural 238U/235U ratio 1 sigma uncertainty. Default <a class="reference internal" href="references.html#hiess2012" id="id15"><span>[HIESS2012]</span></a>.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="pysoplot.cfg.scatter_markers_kw">
<span class="sig-prename descclassname"><span class="pre">pysoplot.cfg.</span></span><span class="sig-name descname"><span class="pre">scatter_markers_kw</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'alpha':</span> <span class="pre">0.3,</span> <span class="pre">'linewidth':</span> <span class="pre">0,</span> <span class="pre">'marker':</span> <span class="pre">',',</span> <span class="pre">'markeredgecolor':</span> <span class="pre">'none',</span> <span class="pre">'markerfacecolor':</span> <span class="pre">'black',</span> <span class="pre">'markersize':</span> <span class="pre">4,</span> <span class="pre">'zorder':</span> <span class="pre">1}</span></em><a class="headerlink" href="#pysoplot.cfg.scatter_markers_kw" title="Permalink to this definition"></a></dt>
<dd><p>Scatter plot marker key-word arguments.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="pysoplot.cfg.spine_kw">
<span class="sig-prename descclassname"><span class="pre">pysoplot.cfg.</span></span><span class="sig-name descname"><span class="pre">spine_kw</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'color':</span> <span class="pre">'red',</span> <span class="pre">'linewidth':</span> <span class="pre">0.8,</span> <span class="pre">'zorder':</span> <span class="pre">100}</span></em><a class="headerlink" href="#pysoplot.cfg.spine_kw" title="Permalink to this definition"></a></dt>
<dd><p>Figure axis spine key-word arguments. Spines are the axis lines.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="pysoplot.cfg.subplot_kw">
<span class="sig-prename descclassname"><span class="pre">pysoplot.cfg.</span></span><span class="sig-name descname"><span class="pre">subplot_kw</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'facecolor':</span> <span class="pre">'white'}</span></em><a class="headerlink" href="#pysoplot.cfg.subplot_kw" title="Permalink to this definition"></a></dt>
<dd><p>subplot_kw passed to matplotlib.pyplot.subplots().</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="pysoplot.cfg.wav_env_kw">
<span class="sig-prename descclassname"><span class="pre">pysoplot.cfg.</span></span><span class="sig-name descname"><span class="pre">wav_env_kw</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'alpha':</span> <span class="pre">0.8,</span> <span class="pre">'edgecolor':</span> <span class="pre">'none',</span> <span class="pre">'facecolor':</span> <span class="pre">'lightgrey',</span> <span class="pre">'linestyle':</span> <span class="pre">'-',</span> <span class="pre">'linewidth':</span> <span class="pre">0.0,</span> <span class="pre">'zorder':</span> <span class="pre">19}</span></em><a class="headerlink" href="#pysoplot.cfg.wav_env_kw" title="Permalink to this definition"></a></dt>
<dd><p>Weighted average envelope key-word arguments.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="pysoplot.cfg.wav_fig_kw">
<span class="sig-prename descclassname"><span class="pre">pysoplot.cfg.</span></span><span class="sig-name descname"><span class="pre">wav_fig_kw</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'dpi':</span> <span class="pre">300,</span> <span class="pre">'facecolor':</span> <span class="pre">'white',</span> <span class="pre">'figsize':</span> <span class="pre">(4.72,</span> <span class="pre">4.012),</span> <span class="pre">'tight_layout':</span> <span class="pre">True}</span></em><a class="headerlink" href="#pysoplot.cfg.wav_fig_kw" title="Permalink to this definition"></a></dt>
<dd><p>Weighted average figure key-word arguments.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="pysoplot.cfg.wav_line_kw">
<span class="sig-prename descclassname"><span class="pre">pysoplot.cfg.</span></span><span class="sig-name descname"><span class="pre">wav_line_kw</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'alpha':</span> <span class="pre">1.0,</span> <span class="pre">'color':</span> <span class="pre">'black',</span> <span class="pre">'linestyle':</span> <span class="pre">'-',</span> <span class="pre">'linewidth':</span> <span class="pre">1.0,</span> <span class="pre">'zorder':</span> <span class="pre">20}</span></em><a class="headerlink" href="#pysoplot.cfg.wav_line_kw" title="Permalink to this definition"></a></dt>
<dd><p>Weighted average line key-word arguments.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="pysoplot.cfg.wav_markers_kw">
<span class="sig-prename descclassname"><span class="pre">pysoplot.cfg.</span></span><span class="sig-name descname"><span class="pre">wav_markers_kw</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'alpha':</span> <span class="pre">1.0,</span> <span class="pre">'color':</span> <span class="pre">'white',</span> <span class="pre">'edgecolor':</span> <span class="pre">'blue',</span> <span class="pre">'linewidth':</span> <span class="pre">1.0,</span> <span class="pre">'zorder':</span> <span class="pre">41}</span></em><a class="headerlink" href="#pysoplot.cfg.wav_markers_kw" title="Permalink to this definition"></a></dt>
<dd><p>Weighted average data point marker key-word arguments.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="pysoplot.cfg.wav_markers_rand_kw">
<span class="sig-prename descclassname"><span class="pre">pysoplot.cfg.</span></span><span class="sig-name descname"><span class="pre">wav_markers_rand_kw</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'alpha':</span> <span class="pre">1.0,</span> <span class="pre">'color':</span> <span class="pre">'blue',</span> <span class="pre">'edgecolor':</span> <span class="pre">'blue',</span> <span class="pre">'linewidth':</span> <span class="pre">1.0,</span> <span class="pre">'zorder':</span> <span class="pre">40}</span></em><a class="headerlink" href="#pysoplot.cfg.wav_markers_rand_kw" title="Permalink to this definition"></a></dt>
<dd><p>Weighted average random only uncertainty data point marker key-word arguments.</p>
</dd></dl>

</section>
<section id="module-pysoplot.concordia">
<span id="pysoplot-concordia-module"></span><h2>pysoplot.concordia module<a class="headerlink" href="#module-pysoplot.concordia" title="Permalink to this heading"></a></h2>
<p>Concordia plotting routines for (dis)equilibrium U-Pb datasets.</p>
<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.concordia.age_ellipse_limits">
<span class="sig-prename descclassname"><span class="pre">pysoplot.concordia.</span></span><span class="sig-name descname"><span class="pre">age_ellipse_limits</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_bounds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sA</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.998</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trials</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diagram</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'tw'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxiter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">40</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">negative_ratios</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.concordia.age_ellipse_limits" title="Permalink to this definition"></a></dt>
<dd><p>Find concordia age ellipse limits near axis window boundaries. Will return
age bound if it is inside the axis window.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t0</strong> (<em>array-like</em>) – Guess at limits (points must be inside plot window).</p></li>
<li><p><strong>dt</strong> (<em>float</em>) – appropriate step size</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.concordia.age_ellipse_marker_spacing">
<span class="sig-prename descclassname"><span class="pre">pysoplot.concordia.</span></span><span class="sig-name descname"><span class="pre">age_ellipse_marker_spacing</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sA</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_bounds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diagram</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'tw'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxiter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">30</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trials</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.concordia.age_ellipse_marker_spacing" title="Permalink to this definition"></a></dt>
<dd><p>Starting with regular concordia age marker spacing and limits, check if
these are also suitable for disequilibrium age ellipses.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.concordia.age_limits">
<span class="sig-prename descclassname"><span class="pre">pysoplot.concordia.</span></span><span class="sig-name descname"><span class="pre">age_limits</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diagram</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">A</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(True,</span> <span class="pre">True)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_bounds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0.01,</span> <span class="pre">4600]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_tries</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.concordia.age_limits" title="Permalink to this definition"></a></dt>
<dd><p>Find concordia age limits at axis window boundaries. Will return age bound
if it is inside the axis window.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.concordia.age_marker_spacing">
<span class="sig-prename descclassname"><span class="pre">pysoplot.concordia.</span></span><span class="sig-name descname"><span class="pre">age_marker_spacing</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diagram</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">A</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_markers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">12</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.concordia.age_marker_spacing" title="Permalink to this definition"></a></dt>
<dd><p>Estimate reasonable concordia age marker spacing given upper and lower
age marker limits.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.concordia.conc_age_ellipse">
<span class="sig-prename descclassname"><span class="pre">pysoplot.concordia.</span></span><span class="sig-name descname"><span class="pre">conc_age_ellipse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diagram</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.concordia.conc_age_ellipse" title="Permalink to this definition"></a></dt>
<dd><p>Age ellipse params for displaying effects of decay constant
errors on equilibrium concordia age markers. Requires computing uncertainty
in x and y for a given t value using first-order error propagation.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.concordia.conc_age_x">
<span class="sig-prename descclassname"><span class="pre">pysoplot.concordia.</span></span><span class="sig-name descname"><span class="pre">conc_age_x</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diagram</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.concordia.conc_age_x" title="Permalink to this definition"></a></dt>
<dd><p>Age of point on concordia at given x value.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.concordia.conc_envelope">
<span class="sig-prename descclassname"><span class="pre">pysoplot.concordia.</span></span><span class="sig-name descname"><span class="pre">conc_envelope</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diagram</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.concordia.conc_envelope" title="Permalink to this definition"></a></dt>
<dd><p>Uncertainty in y for a given x value along the concordia to
display the effects of decay constant errors on trajectory of the concordia
curve. Requires computing uncertainty in y for a given x value using
first-order error propagation.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.concordia.conc_slope">
<span class="sig-prename descclassname"><span class="pre">pysoplot.concordia.</span></span><span class="sig-name descname"><span class="pre">conc_slope</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diagram</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.concordia.conc_slope" title="Permalink to this definition"></a></dt>
<dd><p>Compute tangent to concordia at given t. I.e. dy/dx for given t.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.concordia.conc_xy">
<span class="sig-prename descclassname"><span class="pre">pysoplot.concordia.</span></span><span class="sig-name descname"><span class="pre">conc_xy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diagram</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.concordia.conc_xy" title="Permalink to this definition"></a></dt>
<dd><p>Return x, y for given t along (equilibrium) concordia curve.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.concordia.diseq_age_ellipse">
<span class="sig-prename descclassname"><span class="pre">pysoplot.concordia.</span></span><span class="sig-name descname"><span class="pre">diseq_age_ellipse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sA</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diagram</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pA</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trials</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">negative_ratios</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.concordia.diseq_age_ellipse" title="Permalink to this definition"></a></dt>
<dd><p>Plot disequilibrium concordia marker as an “age ellipse” which provides
a visual representation of uncertainty in x-y for given t value arising from
uncertainties in activity ratio values.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.concordia.diseq_dxdt">
<span class="sig-prename descclassname"><span class="pre">pysoplot.concordia.</span></span><span class="sig-name descname"><span class="pre">diseq_dxdt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diagram</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.concordia.diseq_dxdt" title="Permalink to this definition"></a></dt>
<dd><p>Return x given t along disequilibrium concordia curve.
Used e.g. to compute dx/dt</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.concordia.diseq_equi_points">
<span class="sig-prename descclassname"><span class="pre">pysoplot.concordia.</span></span><span class="sig-name descname"><span class="pre">diseq_equi_points</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diagram</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ngp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">500000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">500</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.concordia.diseq_equi_points" title="Permalink to this definition"></a></dt>
<dd><p>Return ages that give equally spaced x, y points along disequilbrium
concordia between upper and lower age limits.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.concordia.diseq_slope">
<span class="sig-prename descclassname"><span class="pre">pysoplot.concordia.</span></span><span class="sig-name descname"><span class="pre">diseq_slope</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diagram</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.concordia.diseq_slope" title="Permalink to this definition"></a></dt>
<dd><p>Compute tangent to concordia at given t. I.e. dy/dx for given t.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.concordia.diseq_velocity">
<span class="sig-prename descclassname"><span class="pre">pysoplot.concordia.</span></span><span class="sig-name descname"><span class="pre">diseq_velocity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diagram</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.concordia.diseq_velocity" title="Permalink to this definition"></a></dt>
<dd><p>Estimate dr/dt, which is “velocity” along a diseq concordia curve in
x-y space. Uses axis coordinates to circumvent scaling issues.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.concordia.diseq_xy">
<span class="sig-prename descclassname"><span class="pre">pysoplot.concordia.</span></span><span class="sig-name descname"><span class="pre">diseq_xy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diagram</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.concordia.diseq_xy" title="Permalink to this definition"></a></dt>
<dd><p>Return x, y for given t along disequilibrium concordia curve.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.concordia.equi_points">
<span class="sig-prename descclassname"><span class="pre">pysoplot.concordia.</span></span><span class="sig-name descname"><span class="pre">equi_points</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diagram</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ngp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">500000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">500</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.concordia.equi_points" title="Permalink to this definition"></a></dt>
<dd><p>Uses numerical method to obtain age points that are approximately evenly
spaced in x, y along equilibrium U-Pb concordia between age limits t1 and t2.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.concordia.estimate_marker_spacing">
<span class="sig-prename descclassname"><span class="pre">pysoplot.concordia.</span></span><span class="sig-name descname"><span class="pre">estimate_marker_spacing</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tspan</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.concordia.estimate_marker_spacing" title="Permalink to this definition"></a></dt>
<dd><p>Get initial estimate of good concordia marker spacing.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.concordia.get_age_markers">
<span class="sig-prename descclassname"><span class="pre">pysoplot.concordia.</span></span><span class="sig-name descname"><span class="pre">get_age_markers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_bounds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diagram</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ell</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">A</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sA</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">marker_ages</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">()</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">age_prefix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Ma'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">auto</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_segments</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">negative_ratios</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.concordia.get_age_markers" title="Permalink to this definition"></a></dt>
<dd><p>Add concordia markers to concordia line and generate label text (but
does not actually add marker labels).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t1</strong> (<em>float</em>) – lower concordia age in plot,</p></li>
<li><p><strong>t2</strong> (<em>float</em>) – upper concordia age</p></li>
<li><p><strong>ell</strong> (<em>bool</em>) – plot age ellipses</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.concordia.individualised_labels">
<span class="sig-prename descclassname"><span class="pre">pysoplot.concordia.</span></span><span class="sig-name descname"><span class="pre">individualised_labels</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">markers_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diagram</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">A</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_overlaps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.concordia.individualised_labels" title="Permalink to this definition"></a></dt>
<dd><p>Plot concordia age labels using individualised position and rotation.</p>
<p class="rubric">Notes</p>
<p>This routine doesn’t currently work well for disequilibrium concordia curves
that curve back around.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.concordia.labels">
<span class="sig-prename descclassname"><span class="pre">pysoplot.concordia.</span></span><span class="sig-name descname"><span class="pre">labels</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">markers</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.concordia.labels" title="Permalink to this definition"></a></dt>
<dd><p>Add labels to concordia age markers. Uses the same offset and rotation
for each marker.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>markers</strong> (<em>dict</em>) – age marker properties</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.concordia.mc_diseq_envelope">
<span class="sig-prename descclassname"><span class="pre">pysoplot.concordia.</span></span><span class="sig-name descname"><span class="pre">mc_diseq_envelope</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_limits</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_bounds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sA</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diagram</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'tw'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(True,</span> <span class="pre">True)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trials</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">limit_trials</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spaghetti</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxiter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">negative_ratios</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pA</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.concordia.mc_diseq_envelope" title="Permalink to this definition"></a></dt>
<dd><p>Plot uncertainty envelope about disequilibrium concordia based on Monte
Carlo simulation. This displays uncertainty in trajectory of concordia
arising from uncertainty in activity ratio values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t_limits</strong> (<em>array-like</em>) – minimum and maximum concordia ages for given axis window</p></li>
<li><p><strong>t_bounds</strong> – minimum and maximum age bounds for full concordia curve</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.concordia.plot_age_markers">
<span class="sig-prename descclassname"><span class="pre">pysoplot.concordia.</span></span><span class="sig-name descname"><span class="pre">plot_age_markers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">markers</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.95</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.concordia.plot_age_markers" title="Permalink to this definition"></a></dt>
<dd><p>Add age markers to plot.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>markers</strong> (<em>dict</em>) – age marker properties, typically returned from calling get_age_markers</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.concordia.plot_concordia">
<span class="sig-prename descclassname"><span class="pre">pysoplot.concordia.</span></span><span class="sig-name descname"><span class="pre">plot_concordia</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diagram</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_markers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">env</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">age_ellipses</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">marker_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">marker_ages</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">()</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">auto_markers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_overlaps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">age_prefix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Ma'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.concordia.plot_concordia" title="Permalink to this definition"></a></dt>
<dd><p>Plot equilibrium U-Pb concordia curve on concordia diagram.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ax</strong> (<em>matplotlib.pyplot.Axes</em>) – Axes object to plot concordia curve in.</p></li>
<li><p><strong>diagram</strong> (<em>{'tw'</em><em>, </em><em>'wc'}</em>) – Concordia diagram type.</p></li>
<li><p><strong>marker_max</strong> (<em>float</em><em>, </em><em>optional</em>) – User specified age marker max (Ma).</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>UserWarning</strong> – if concordia lies entirely outside the axis limits.:</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.concordia.plot_diseq_concordia">
<span class="sig-prename descclassname"><span class="pre">pysoplot.concordia.</span></span><span class="sig-name descname"><span class="pre">plot_diseq_concordia</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diagram</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sA</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">age_ellipses</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_markers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">marker_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">env</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">env_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mc'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">marker_ages</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">()</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">auto_markers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spaghetti</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pA</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_overlaps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">env_trials</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">negative_ratios</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">age_prefix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Ma'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.concordia.plot_diseq_concordia" title="Permalink to this definition"></a></dt>
<dd><p>Plot disequilibrium U-Pb concordia curve on concordia diagram.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ax</strong> (<em>matplotlib.pyplot.Axes</em>) – Axes object to plot concordia curve in.</p></li>
<li><p><strong>A</strong> (<em>array-like</em>) – one-dimensional array of activity ratio values arranged as follows
- [234U/238U], [230Th/238U], [226Ra/238U], [231Pa/235U]</p></li>
<li><p><strong>init</strong> (<em>array-like</em>) – two-element list of boolean values, the first is True if [234U/238U]
is an initial value and False if a present-day value, the second is True
if [230Th/238U] is an initial value and False if a present-day value</p></li>
<li><p><strong>sA</strong> (<em>array-like</em><em>, </em><em>optional</em>) – one-dimensional array of activity ratio value uncertainties given
as 1 sigma absolute and arranged in the same order as A</p></li>
<li><p><strong>diagram</strong> (<em>{'tw'</em><em>, </em><em>'wc'}</em>) – Concordia diagram type.</p></li>
<li><p><strong>marker_max</strong> (<em>float</em><em>, </em><em>optional</em>) – User specified age marker max (Ma).</p></li>
<li><p><strong>spaghetti</strong> (<em>bool</em>) – plot each simulated line using arbitrary colours</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>UserWarning</strong> – if concordia lies entirely outside the axis limits.:</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.concordia.plot_envelope">
<span class="sig-prename descclassname"><span class="pre">pysoplot.concordia.</span></span><span class="sig-name descname"><span class="pre">plot_envelope</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diagram</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">npts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.concordia.plot_envelope" title="Permalink to this definition"></a></dt>
<dd><p>Plot concordia uncertainty envelope which displays effect of decay constant
errors.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.concordia.refine_t_limit">
<span class="sig-prename descclassname"><span class="pre">pysoplot.concordia.</span></span><span class="sig-name descname"><span class="pre">refine_t_limit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">limits0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_bounds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">increasing_t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diagram</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'tw'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">A</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sA</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(True,</span> <span class="pre">True)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ell</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trials</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.concordia.refine_t_limit" title="Permalink to this definition"></a></dt>
<dd><p>Refine concordia age limits so they lie just outside axis window. Will
return age bound if it is inside the axis window.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tmin</strong> (<em>float</em>) – lowder t-bound</p></li>
<li><p><strong>tmax</strong> (<em>float</em>) – upper t-bound</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.concordia.remove_overlapping_labels">
<span class="sig-prename descclassname"><span class="pre">pysoplot.concordia.</span></span><span class="sig-name descname"><span class="pre">remove_overlapping_labels</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">an</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.concordia.remove_overlapping_labels" title="Permalink to this definition"></a></dt>
<dd><p>Naive routine for removing overlapping concordia labels older than first
overlap point.</p>
<dl class="simple">
<dt>an<span class="classifier">array-like</span></dt><dd><p>list of concordia age marker / ellipse label annotations</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.concordia.segment_2_markers">
<span class="sig-prename descclassname"><span class="pre">pysoplot.concordia.</span></span><span class="sig-name descname"><span class="pre">segment_2_markers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_bounds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">markers</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.concordia.segment_2_markers" title="Permalink to this definition"></a></dt>
<dd><p>Function for adding markers to the second concordia
segment (uses spacing etc. from first segement).</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.concordia.t_limits_from_cp">
<span class="sig-prename descclassname"><span class="pre">pysoplot.concordia.</span></span><span class="sig-name descname"><span class="pre">t_limits_from_cp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inside</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tmin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tmax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.concordia.t_limits_from_cp" title="Permalink to this definition"></a></dt>
<dd><p>Get estimated concordia age bounds from arbitrary age points within
the plot window.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.concordia.velocity">
<span class="sig-prename descclassname"><span class="pre">pysoplot.concordia.</span></span><span class="sig-name descname"><span class="pre">velocity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diagram</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.concordia.velocity" title="Permalink to this definition"></a></dt>
<dd><p>Estimate dr/dt, which is “velocity” along an equilibrium concordia curve in
x-y space. Uses axis coordinates to circumvent scaling issues.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.concordia.walk_ellipse_outward">
<span class="sig-prename descclassname"><span class="pre">pysoplot.concordia.</span></span><span class="sig-name descname"><span class="pre">walk_ellipse_outward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_bounds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diagram</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xtol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ytol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trials</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">A</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pA</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ttol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.999</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.concordia.walk_ellipse_outward" title="Permalink to this definition"></a></dt>
<dd><p>Walk outward from t0 until an axis boundary is found (i.e. ellipse is
pretty much outside axis window, where ‘pretty-muchness’ is determined
by p).</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.concordia.walk_outward">
<span class="sig-prename descclassname"><span class="pre">pysoplot.concordia.</span></span><span class="sig-name descname"><span class="pre">walk_outward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_bounds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diagram</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xtol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ytol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">A</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(True,</span> <span class="pre">True)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ttol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ell</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pA</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.concordia.walk_outward" title="Permalink to this definition"></a></dt>
<dd><p>Walk outward from t0 until an axis boundary is found.</p>
</dd></dl>

</section>
<section id="pysoplot-corrected-module">
<h2>pysoplot.corrected module<a class="headerlink" href="#pysoplot-corrected-module" title="Permalink to this heading"></a></h2>
</section>
<section id="module-pysoplot.data">
<span id="pysoplot-data-module"></span><h2>pysoplot.data module<a class="headerlink" href="#module-pysoplot.data" title="Permalink to this heading"></a></h2>
<p>Test data sets.</p>
<dl class="py data">
<dt class="sig sig-object py" id="pysoplot.data.KAMO1996">
<span class="sig-prename descclassname"><span class="pre">pysoplot.data.</span></span><span class="sig-name descname"><span class="pre">KAMO1996</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'tw':</span> <span class="pre">[[25.094102886,</span> <span class="pre">0.200752823,</span> <span class="pre">0.05131,</span> <span class="pre">0.156],</span> <span class="pre">[25.125628141,</span> <span class="pre">0.201005025,</span> <span class="pre">0.051284216,</span> <span class="pre">0.623],</span> <span class="pre">[25.138260432,</span> <span class="pre">0.502765209,</span> <span class="pre">0.05131,</span> <span class="pre">0.312],</span> <span class="pre">[25.150905433,</span> <span class="pre">0.251509054,</span> <span class="pre">0.05129,</span> <span class="pre">0.351],</span> <span class="pre">[25.176233635,</span> <span class="pre">0.201409869,</span> <span class="pre">0.05139,</span> <span class="pre">0.234],</span> <span class="pre">[25.182573659,</span> <span class="pre">0.503651473,</span> <span class="pre">0.05134,</span> <span class="pre">0.273],</span> <span class="pre">[25.207965717,</span> <span class="pre">0.201663726,</span> <span class="pre">0.05143,</span> <span class="pre">0.428],</span> <span class="pre">[25.214321735,</span> <span class="pre">0.302571861,</span> <span class="pre">0.05139,</span> <span class="pre">0.272],</span> <span class="pre">[25.163563161,</span> <span class="pre">0.201308505,</span> <span class="pre">0.0514,</span> <span class="pre">0.233],</span> <span class="pre">[27.723870252,</span> <span class="pre">0.277238703,</span> <span class="pre">0.05135,</span> <span class="pre">0.156]],</span> <span class="pre">'wc':</span> <span class="pre">[[0.28192371858,</span> <span class="pre">0.25418731559,</span> <span class="pre">0.03985,</span> <span class="pre">0.200752823087,</span> <span class="pre">0.789783009514],</span> <span class="pre">[0.281428494984,</span> <span class="pre">0.65490496998,</span> <span class="pre">0.0398,</span> <span class="pre">0.201005025126,</span> <span class="pre">0.306922430489],</span> <span class="pre">[0.281428494984,</span> <span class="pre">0.59161713696,</span> <span class="pre">0.03978,</span> <span class="pre">0.502765208648,</span> <span class="pre">0.849815154496],</span> <span class="pre">[0.281177360352,</span> <span class="pre">0.431763385404,</span> <span class="pre">0.03976,</span> <span class="pre">0.251509054326,</span> <span class="pre">0.582515940045],</span> <span class="pre">[0.281442145104,</span> <span class="pre">0.308370132215,</span> <span class="pre">0.03972,</span> <span class="pre">0.201409869084,</span> <span class="pre">0.653143245868],</span> <span class="pre">[0.281097527832,</span> <span class="pre">0.572735240723,</span> <span class="pre">0.03971,</span> <span class="pre">0.503651473181,</span> <span class="pre">0.879379226857],</span> <span class="pre">[0.281306650428,</span> <span class="pre">0.472918512578,</span> <span class="pre">0.03967,</span> <span class="pre">0.201663725737,</span> <span class="pre">0.426423834919],</span> <span class="pre">[0.281017005912,</span> <span class="pre">0.407143650097,</span> <span class="pre">0.03966,</span> <span class="pre">0.302571860817,</span> <span class="pre">0.743157509014],</span> <span class="pre">[0.28163865168,</span> <span class="pre">0.308269529828,</span> <span class="pre">0.03974,</span> <span class="pre">0.201308505284,</span> <span class="pre">0.653027580756],</span> <span class="pre">[0.25538057766,</span> <span class="pre">0.318014049572,</span> <span class="pre">0.03607,</span> <span class="pre">0.277238702523,</span> <span class="pre">0.871781303046]]}</span></em><a class="headerlink" href="#pysoplot.data.KAMO1996" title="Permalink to this definition"></a></dt>
<dd><p>0708-LA speleothm LA-ICPMS
Woodhead, J., Petrus, J., 2019. Exploring the advantages and limitations of
in situ U–Pb carbonate geochronology using speleothems. Geochronology 1, 69–84.
<a class="reference external" href="https://doi.org/10.5194/gchron-1-69-2019">https://doi.org/10.5194/gchron-1-69-2019</a></p>
<p>Tera-Wasserburg data (errors 2s, abs.)</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="pysoplot.data.LA0708">
<span class="sig-prename descclassname"><span class="pre">pysoplot.data.</span></span><span class="sig-name descname"><span class="pre">LA0708</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">[[73.21,</span> <span class="pre">2.25,</span> <span class="pre">0.753,</span> <span class="pre">0.015,</span> <span class="pre">-0.068],</span> <span class="pre">[260.42,</span> <span class="pre">8.14,</span> <span class="pre">0.435,</span> <span class="pre">0.02,</span> <span class="pre">0.189],</span> <span class="pre">[169.2,</span> <span class="pre">4.87,</span> <span class="pre">0.577,</span> <span class="pre">0.02,</span> <span class="pre">0.456],</span> <span class="pre">[79.18,</span> <span class="pre">1.82,</span> <span class="pre">0.751,</span> <span class="pre">0.02,</span> <span class="pre">0.196],</span> <span class="pre">[212.77,</span> <span class="pre">5.89,</span> <span class="pre">0.473,</span> <span class="pre">0.017,</span> <span class="pre">0.375],</span> <span class="pre">[154.56,</span> <span class="pre">3.58,</span> <span class="pre">0.615,</span> <span class="pre">0.021,</span> <span class="pre">0.226],</span> <span class="pre">[217.39,</span> <span class="pre">5.67,</span> <span class="pre">0.474,</span> <span class="pre">0.019,</span> <span class="pre">0.279],</span> <span class="pre">[209.64,</span> <span class="pre">9.67,</span> <span class="pre">0.484,</span> <span class="pre">0.022,</span> <span class="pre">0.11],</span> <span class="pre">[144.09,</span> <span class="pre">4.98,</span> <span class="pre">0.647,</span> <span class="pre">0.021,</span> <span class="pre">0.102],</span> <span class="pre">[174.22,</span> <span class="pre">3.95,</span> <span class="pre">0.584,</span> <span class="pre">0.018,</span> <span class="pre">0.214],</span> <span class="pre">[224.22,</span> <span class="pre">6.54,</span> <span class="pre">0.477,</span> <span class="pre">0.024,</span> <span class="pre">0.265],</span> <span class="pre">[236.41,</span> <span class="pre">6.71,</span> <span class="pre">0.461,</span> <span class="pre">0.023,</span> <span class="pre">0.147],</span> <span class="pre">[161.55,</span> <span class="pre">5.74,</span> <span class="pre">0.628,</span> <span class="pre">0.022,</span> <span class="pre">-0.041],</span> <span class="pre">[265.25,</span> <span class="pre">11.26,</span> <span class="pre">0.385,</span> <span class="pre">0.023,</span> <span class="pre">-0.043],</span> <span class="pre">[152.44,</span> <span class="pre">4.65,</span> <span class="pre">0.608,</span> <span class="pre">0.019,</span> <span class="pre">0.02],</span> <span class="pre">[151.75,</span> <span class="pre">4.61,</span> <span class="pre">0.626,</span> <span class="pre">0.021,</span> <span class="pre">0.003],</span> <span class="pre">[101.11,</span> <span class="pre">2.35,</span> <span class="pre">0.727,</span> <span class="pre">0.017,</span> <span class="pre">0.038],</span> <span class="pre">[265.18,</span> <span class="pre">6.82,</span> <span class="pre">0.427,</span> <span class="pre">0.019,</span> <span class="pre">0.07],</span> <span class="pre">[286.78,</span> <span class="pre">6.33,</span> <span class="pre">0.391,</span> <span class="pre">0.017,</span> <span class="pre">0.241],</span> <span class="pre">[287.6,</span> <span class="pre">7.11,</span> <span class="pre">0.365,</span> <span class="pre">0.016,</span> <span class="pre">-0.041],</span> <span class="pre">[264.69,</span> <span class="pre">5.67,</span> <span class="pre">0.419,</span> <span class="pre">0.016,</span> <span class="pre">0.159],</span> <span class="pre">[274.57,</span> <span class="pre">5.35,</span> <span class="pre">0.378,</span> <span class="pre">0.016,</span> <span class="pre">0.177],</span> <span class="pre">[212.31,</span> <span class="pre">8.56,</span> <span class="pre">0.501,</span> <span class="pre">0.026,</span> <span class="pre">0.341],</span> <span class="pre">[161.29,</span> <span class="pre">3.38,</span> <span class="pre">0.591,</span> <span class="pre">0.018,</span> <span class="pre">0.144],</span> <span class="pre">[140.65,</span> <span class="pre">3.17,</span> <span class="pre">0.633,</span> <span class="pre">0.021,</span> <span class="pre">0.188],</span> <span class="pre">[183.15,</span> <span class="pre">4.36,</span> <span class="pre">0.557,</span> <span class="pre">0.021,</span> <span class="pre">0.494],</span> <span class="pre">[218.82,</span> <span class="pre">4.79,</span> <span class="pre">0.53,</span> <span class="pre">0.024,</span> <span class="pre">0.217],</span> <span class="pre">[312.5,</span> <span class="pre">10.74,</span> <span class="pre">0.334,</span> <span class="pre">0.02,</span> <span class="pre">-0.081],</span> <span class="pre">[227.79,</span> <span class="pre">4.41,</span> <span class="pre">0.49,</span> <span class="pre">0.021,</span> <span class="pre">0.073],</span> <span class="pre">[212.77,</span> <span class="pre">5.43,</span> <span class="pre">0.507,</span> <span class="pre">0.022,</span> <span class="pre">0.255],</span> <span class="pre">[139.28,</span> <span class="pre">4.07,</span> <span class="pre">0.652,</span> <span class="pre">0.02,</span> <span class="pre">0.449],</span> <span class="pre">[179.53,</span> <span class="pre">4.51,</span> <span class="pre">0.556,</span> <span class="pre">0.021,</span> <span class="pre">0.243],</span> <span class="pre">[224.22,</span> <span class="pre">5.03,</span> <span class="pre">0.48,</span> <span class="pre">0.017,</span> <span class="pre">0.112],</span> <span class="pre">[219.78,</span> <span class="pre">7.25,</span> <span class="pre">0.519,</span> <span class="pre">0.023,</span> <span class="pre">0.313],</span> <span class="pre">[165.02,</span> <span class="pre">5.72,</span> <span class="pre">0.59,</span> <span class="pre">0.023,</span> <span class="pre">0.036],</span> <span class="pre">[145.77,</span> <span class="pre">4.67,</span> <span class="pre">0.61,</span> <span class="pre">0.021,</span> <span class="pre">0.099],</span> <span class="pre">[239.81,</span> <span class="pre">8.05,</span> <span class="pre">0.442,</span> <span class="pre">0.019,</span> <span class="pre">-0.105],</span> <span class="pre">[187.27,</span> <span class="pre">5.61,</span> <span class="pre">0.538,</span> <span class="pre">0.025,</span> <span class="pre">0.119],</span> <span class="pre">[255.23,</span> <span class="pre">5.28,</span> <span class="pre">0.443,</span> <span class="pre">0.017,</span> <span class="pre">0.026],</span> <span class="pre">[141.44,</span> <span class="pre">8.2,</span> <span class="pre">0.616,</span> <span class="pre">0.022,</span> <span class="pre">-0.155],</span> <span class="pre">[115.34,</span> <span class="pre">2.0,</span> <span class="pre">0.707,</span> <span class="pre">0.02,</span> <span class="pre">0.151],</span> <span class="pre">[117.51,</span> <span class="pre">2.35,</span> <span class="pre">0.68,</span> <span class="pre">0.016,</span> <span class="pre">0.339],</span> <span class="pre">[73.64,</span> <span class="pre">1.25,</span> <span class="pre">0.757,</span> <span class="pre">0.013,</span> <span class="pre">0.579],</span> <span class="pre">[160.26,</span> <span class="pre">4.62,</span> <span class="pre">0.605,</span> <span class="pre">0.024,</span> <span class="pre">0.164],</span> <span class="pre">[149.7,</span> <span class="pre">3.14,</span> <span class="pre">0.619,</span> <span class="pre">0.018,</span> <span class="pre">0.246],</span> <span class="pre">[245.28,</span> <span class="pre">5.17,</span> <span class="pre">0.452,</span> <span class="pre">0.016,</span> <span class="pre">0.337],</span> <span class="pre">[251.26,</span> <span class="pre">8.21,</span> <span class="pre">0.435,</span> <span class="pre">0.028,</span> <span class="pre">0.359],</span> <span class="pre">[130.21,</span> <span class="pre">4.24,</span> <span class="pre">0.666,</span> <span class="pre">0.022,</span> <span class="pre">0.184],</span> <span class="pre">[276.24,</span> <span class="pre">8.39,</span> <span class="pre">0.419,</span> <span class="pre">0.02,</span> <span class="pre">0.167],</span> <span class="pre">[298.51,</span> <span class="pre">9.8,</span> <span class="pre">0.359,</span> <span class="pre">0.021,</span> <span class="pre">-0.091],</span> <span class="pre">[381.68,</span> <span class="pre">12.82,</span> <span class="pre">0.241,</span> <span class="pre">0.026,</span> <span class="pre">0.007]]</span></em><a class="headerlink" href="#pysoplot.data.LA0708" title="Permalink to this definition"></a></dt>
<dd><p>Young carbonate 238U-206Pb and 235U-207Pb isochron
Richards, D.A., Bottrell, S.H., Cliff, R.A., Ströhle, K., Rowe, P.J., 1998.
U-Pb dating of a speleothem of Quaternary age. Geochimica et Cosmochimica Acta
62, 3683–3688. <a class="reference external" href="https://doi.org/10.1016/S0016-7037(98)00256-7">https://doi.org/10.1016/S0016-7037(98)00256-7</a></p>
<p>Note: results are not directly comparable to publication, because data point
uncertainty correlations are assumed equal to 0 here but we can see from figs
in the article that this is not a great assumption.</p>
<p>235U/204Pb ratios are computed from 238U/204Pb ratios assuming 238U/235U =
137.88.</p>
<p>Isochron dataset
DP errors: 2s, abs.
Activity ratio errors: 1s, abs.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="pysoplot.data.WHC1">
<span class="sig-prename descclassname"><span class="pre">pysoplot.data.</span></span><span class="sig-name descname"><span class="pre">WHC1</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'A':</span> <span class="pre">[1.155,</span> <span class="pre">0.0,</span> <span class="pre">0.0],</span> <span class="pre">'init':</span> <span class="pre">[False,</span> <span class="pre">True],</span> <span class="pre">'iso57-4':</span> <span class="pre">[[11.45923992,</span> <span class="pre">0.652741514,</span> <span class="pre">15.25,</span> <span class="pre">0.18],</span> <span class="pre">[111.6913258,</span> <span class="pre">2.901073397,</span> <span class="pre">15.43,</span> <span class="pre">0.92],</span> <span class="pre">[5.076878445,</span> <span class="pre">1.378009864,</span> <span class="pre">15.15,</span> <span class="pre">0.25],</span> <span class="pre">[8275.311865,</span> <span class="pre">1573.832318,</span> <span class="pre">17.22,</span> <span class="pre">1.0],</span> <span class="pre">[1624.601102,</span> <span class="pre">65.27415144,</span> <span class="pre">15.81,</span> <span class="pre">0.25],</span> <span class="pre">[1037.133739,</span> <span class="pre">43.51610096,</span> <span class="pre">15.55,</span> <span class="pre">0.45],</span> <span class="pre">[1436.031332,</span> <span class="pre">79.77951842,</span> <span class="pre">15.79,</span> <span class="pre">0.56],</span> <span class="pre">[3996.228605,</span> <span class="pre">514.940528,</span> <span class="pre">16.24,</span> <span class="pre">0.67]],</span> <span class="pre">'iso68-4':</span> <span class="pre">[[1580.0,</span> <span class="pre">90.0,</span> <span class="pre">17.58,</span> <span class="pre">0.15],</span> <span class="pre">[15400.0,</span> <span class="pre">400.0,</span> <span class="pre">17.85,</span> <span class="pre">0.44],</span> <span class="pre">[700.0,</span> <span class="pre">190.0,</span> <span class="pre">17.08,</span> <span class="pre">0.09],</span> <span class="pre">[1141000,</span> <span class="pre">217000,</span> <span class="pre">49.77,</span> <span class="pre">6.1],</span> <span class="pre">[224000.0,</span> <span class="pre">9000.0,</span> <span class="pre">23.98,</span> <span class="pre">0.25],</span> <span class="pre">[143000.0,</span> <span class="pre">6000.0,</span> <span class="pre">21.25,</span> <span class="pre">0.25],</span> <span class="pre">[198000.0,</span> <span class="pre">11000.0,</span> <span class="pre">23.26,</span> <span class="pre">0.43],</span> <span class="pre">[551000.0,</span> <span class="pre">71000.0,</span> <span class="pre">32.58,</span> <span class="pre">1.95]],</span> <span class="pre">'sA':</span> <span class="pre">[0.0145,</span> <span class="pre">0.0,</span> <span class="pre">0.0]}</span></em><a class="headerlink" href="#pysoplot.data.WHC1" title="Permalink to this definition"></a></dt>
<dd><p>Charm particle data
Lyons, L., Gibaut, D., Clifford, P., 1988. How to combine correlated estimates
of a single physical quantity. Nuclear Instruments and Methods in Physics
Research Section A: Accelerators, Spectrometers, Detectors and Associated
Equipment 270, 110–117. <a class="reference external" href="https://doi.org/10.1016/0168-9002(88)90018-6">https://doi.org/10.1016/0168-9002(88)90018-6</a></p>
<p>For testing wtd. average functions with correlated uncertainties.</p>
</dd></dl>

</section>
<section id="pysoplot-dqmc-module">
<h2>pysoplot.dqmc module<a class="headerlink" href="#pysoplot-dqmc-module" title="Permalink to this heading"></a></h2>
</section>
<section id="module-pysoplot.dqpb">
<span id="pysoplot-dqpb-module"></span><h2>pysoplot.dqpb module<a class="headerlink" href="#module-pysoplot.dqpb" title="Permalink to this heading"></a></h2>
<p>Functions and routines for computing disequilibrium U-Pb ages.</p>
<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.dqpb.concint">
<span class="sig-prename descclassname"><span class="pre">pysoplot.dqpb.</span></span><span class="sig-name descname"><span class="pre">concint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.dqpb.concint" title="Permalink to this definition"></a></dt>
<dd><p>Numercially compute disequilibrium U-Pb concordia-intercept age.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.dqpb.concint_age">
<span class="sig-prename descclassname"><span class="pre">pysoplot.dqpb.</span></span><span class="sig-name descname"><span class="pre">concint_age</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fit</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sA</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diagram</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'tw'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dc_errors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trials</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u_errors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">negative_ratios</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">negative_ages</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intercept_plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hist</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(False,</span> <span class="pre">False)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conc_kw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intercept_plot_kw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">A48i_lim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0.0,</span> <span class="pre">20.0)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">A08i_lim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0.0,</span> <span class="pre">10.0)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">age_lim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0.0,</span> <span class="pre">20.0)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uncert</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mc'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.dqpb.concint_age" title="Permalink to this definition"></a></dt>
<dd><p>Compute disequilibrium U-Pb concordia intercept age and age uncertainties
using Monte Carlo simulation. Optionally, produce a plot of the
concordia intercept.</p>
<p class="rubric">Notes</p>
<p>Only accepts data in 2-D Tera-Wasserburg form at present.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fit</strong> (<em>dict</em>) – Linear regression fit parameters.</p></li>
<li><p><strong>A</strong> (<em>array-like</em>) – One-dimensional array of activity ratio values arranged as follows
- [234U/238U], [230Th/238U], [226Ra/238U], [231Pa/235U].</p></li>
<li><p><strong>sA</strong> (<em>array-like</em>) – One-dimensional array of activity ratio value uncertainties given
as 1 sigma absolute and arranged in the same order as A.</p></li>
<li><p><strong>init</strong> (<em>array-like</em>) – Two-element list of boolean values, the first is True if [234U/238U]
is an initial value and False if a present-day value, the second is True
if [230Th/238U] is an initial value and False if a present-day value.</p></li>
<li><p><strong>t0</strong> (<em>float</em>) – Initial guess for numerical age solving (the equilibrium age is
typically good enough).</p></li>
<li><p><strong>uncert</strong> (<em>{'mc'</em><em>, </em><em>'none'}</em>) – Method of computing age uncertainties.</p></li>
<li><p><strong>diagram</strong> (<em>{'tw'}</em>) – Concordia diagram type. Currently only accepts ‘tw’, i.e.
Tera-Waserburg.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.dqpb.concint_multiple">
<span class="sig-prename descclassname"><span class="pre">pysoplot.dqpb.</span></span><span class="sig-name descname"><span class="pre">concint_multiple</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">age_lim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0.0,</span> <span class="pre">20.0)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">A48i_lim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0.0,</span> <span class="pre">20.0)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">A08i_lim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0.0,</span> <span class="pre">20.0)</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.dqpb.concint_multiple" title="Permalink to this definition"></a></dt>
<dd><p>Search for all initial disequilibrium concordia-intercept age solutions
within specified age and initial activity ratio limits.</p>
<p>If both [234U/238U] and [230Th/238U] are inputted as present-day
values, it is possible for the concordia curve to curve around leading to two
concordia intercepts in close age proximity. Typically, where this is the
case, it seems the  upper intercept will have a physically implausible
initial activity ratio solution, so lower intercept is chosen.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.dqpb.concordant_A48i">
<span class="sig-prename descclassname"><span class="pre">pysoplot.dqpb.</span></span><span class="sig-name descname"><span class="pre">concordant_A48i</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t75</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b86</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a230_238</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a226_238</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Lam238</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coef238</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.dqpb.concordant_A48i" title="Permalink to this definition"></a></dt>
<dd><p>Numerically compute initial U234/U238 activity ratio that forces concordance
between 238U and 235U isochron ages.</p>
<p>Minimises function: f = F(t75, A234A238) - slope_86, where t75 is
the 207Pb/x-235U/x isochron age.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.dqpb.cor207">
<span class="sig-prename descclassname"><span class="pre">pysoplot.dqpb.</span></span><span class="sig-name descname"><span class="pre">cor207</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(True,</span> <span class="pre">True)</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.dqpb.cor207" title="Permalink to this definition"></a></dt>
<dd><p>Numerically compute disequilibrium 207Pb-corrected ages.</p>
<p class="rubric">References</p>
<p>Ludwig, K.R., 1977. Effect of initial radioactive-daughter disequilibrium
on U-Pb isotope apparent ages of young minerals. Journal of Research of
the US Geological Survey 5, 663–667.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.dqpb.find_roots">
<span class="sig-prename descclassname"><span class="pre">pysoplot.dqpb.</span></span><span class="sig-name descname"><span class="pre">find_roots</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0.0,</span> <span class="pre">20.0)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rtol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-09</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.dqpb.find_roots" title="Permalink to this definition"></a></dt>
<dd><p>Use brute force method to find all roots within given age range. Not
guaranteed to work if two roots are close together, so use small step
size.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.dqpb.forced_concordance">
<span class="sig-prename descclassname"><span class="pre">pysoplot.dqpb.</span></span><span class="sig-name descname"><span class="pre">forced_concordance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fit57</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fit86</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sA</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_isotope</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'204Pb'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">negative_ratios</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">negative_ages</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hist</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(False,</span> <span class="pre">False)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trials</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50000</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.dqpb.forced_concordance" title="Permalink to this definition"></a></dt>
<dd><p>Compute “forced concordance” [234U/238U] value following the approach of
Engel et al. (2019).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fit57</strong> (<em>dict</em>) – 207Pb isochron linear regression fit</p></li>
<li><p><strong>fit86</strong> (<em>dict</em>) – 206Pb isochron linear regression fit</p></li>
<li><p><strong>A</strong> (<em>array-like</em>) – one-dimensional array of activity ratio values arranged as follows
- np.nan, [230Th/238U], [226Ra/238U], [231Pa/235U]</p></li>
<li><p><strong>sA</strong> (<em>array-like</em>) – one-dimensional array of activity ratio value uncertainties given
as 1 sigma absolute and arranged in the same order as A</p></li>
</ul>
</dd>
</dl>
<p class="rubric">References</p>
<p>Engel, J., Woodhead, J., Hellstrom, J., Maas, R., Drysdale, R., Ford, D.,
2019. Corrections for initial isotopic disequilibrium in the speleothem
U-Pb dating method. Quaternary Geochronology 54, 101009.
<a class="reference external" href="https://doi.org/10.1016/j.quageo.2019.101009">https://doi.org/10.1016/j.quageo.2019.101009</a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.dqpb.isochron">
<span class="sig-prename descclassname"><span class="pre">pysoplot.dqpb.</span></span><span class="sig-name descname"><span class="pre">isochron</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">age_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(True,</span> <span class="pre">True)</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.dqpb.isochron" title="Permalink to this definition"></a></dt>
<dd><p>Numerically compute disequilbrium U-Pb isohcron age.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.dqpb.isochron_age">
<span class="sig-prename descclassname"><span class="pre">pysoplot.dqpb.</span></span><span class="sig-name descname"><span class="pre">isochron_age</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fit</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sA</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(True,</span> <span class="pre">True)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">age_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'iso-206Pb'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_isotope</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'204Pb'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hist</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(False,</span> <span class="pre">False)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trials</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dc_errors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">negative_ratios</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">negative_ages</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.dqpb.isochron_age" title="Permalink to this definition"></a></dt>
<dd><p>Compute disequilibrium 238U-206Pb or 235U-207Pb isochron age and Monte
Carlo age uncertainties.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fit</strong> (<em>dict</em>) – linear regression fit parameters</p></li>
<li><p><strong>A</strong> (<em>array-like</em>) – one-dimensional array of activity ratio values arranged as follows
- [234U/238U], [230Th/238U], [226Ra/238U], [231Pa/235U]</p></li>
<li><p><strong>sA</strong> (<em>array-like</em>) – one-dimensional array of activity ratio value uncertainties given
as 1 sigma absolute and arranged in the same order as A</p></li>
<li><p><strong>init</strong> (<em>array-like</em>) – two-element list of boolean values, the first is True if [234U/238U]
is an initial value and False if a present-day value, the second is True
if [230Th/238U] is an initial value and False if a present-day value</p></li>
<li><p><strong>t0</strong> (<em>float</em>) – initial guess for numerical age solving (the equilibrium age is
typically good enough)</p></li>
<li><p><strong>age_type</strong> (<em>{'iso-206Pb'</em><em>, </em><em>'iso-207Pb'}</em>) – Isochron age type.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.dqpb.pbu">
<span class="sig-prename descclassname"><span class="pre">pysoplot.dqpb.</span></span><span class="sig-name descname"><span class="pre">pbu</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">age_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(True,</span> <span class="pre">True)</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.dqpb.pbu" title="Permalink to this definition"></a></dt>
<dd><p>Numerically compute single analysis Pb/U age using Ludwig equations.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.dqpb.pbu_age">
<span class="sig-prename descclassname"><span class="pre">pysoplot.dqpb.</span></span><span class="sig-name descname"><span class="pre">pbu_age</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Vx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">DThU</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">DThU_1s</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">DPaU</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">DPaU_1s</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha_1s</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">age_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'206Pb*'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uncert</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'analytical'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rand</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wav</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wav_opts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mc_opts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.dqpb.pbu_age" title="Permalink to this definition"></a></dt>
<dd><p>Compute disequilibrium radiogenic 206Pb*/238U, 207Pb*/235U ages, or
207Pb-corrected age assuming a constant ratio of minerl-melt partition
coefficients, and optionally compute a weighted average age.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>ndarray</em><em> (</em><em>1-D</em><em>, </em><em>2-D</em><em>)</em>) – Either a 1 x n array of measured 206Pb*/238U for each aliquot (for
206Pb* age), or 2 x n array of measured 238U/206Pb and 207Pb/206Pb (for
207Pb-corrected age).</p></li>
<li><p><strong>Vx</strong> (<em>ndarray</em><em> (</em><em>2-D</em><em>)</em>) – Covariance matrix of uncertainties on measured isotope ratios. This
should be an n x n array for 206Pb* and 207Pb* ages, or a 2n x 2n array
for 207Pb-corrected ages.</p></li>
<li><p><strong>DThU</strong> (<em>float</em><em>, </em><em>optional</em>) – Ratio of mineral-melt distribution coefficients, DTh/DU.</p></li>
<li><p><strong>DThU_1s</strong> (<em>float</em><em>, </em><em>optional</em>) – Uncertainty on ratio of mineral-melt distribution coefficients, DTh/DU.</p></li>
<li><p><strong>DPaU</strong> (<em>float</em><em>, </em><em>optional</em>) – Ratio of mineral-melt distribution coefficients, DPu/DU.</p></li>
<li><p><strong>DPaU_1s</strong> (<em>float</em><em>, </em><em>optional</em>) – Uncertainty on ratio of mineral-melt distribution coefficients, DPu/DU.</p></li>
<li><p><strong>alpha</strong> (<em>float</em><em>, </em><em>optional</em>) – Common 207Pb/206Pb ratio.</p></li>
<li><p><strong>alpha_1s</strong> (<em>float</em><em>, </em><em>optional</em>) – Uncertainty on common 207Pb/206Pb ratio.</p></li>
<li><p><strong>t0</strong> (<em>ndarray</em><em> or </em><em>float</em><em>, </em><em>optional</em>) – Age guess(es).</p></li>
<li><p><strong>uncert</strong> (<em>{'mc'</em><em>, </em><em>'analytical'}</em><em>, </em><em>optional</em>) – Method of propagating age uncertainties.</p></li>
<li><p><strong>rand</strong> (<em>bool</em>) – If true, compute random only uncertainties as well as total
uncertainties (e.g., for plotting error bars).</p></li>
<li><p><strong>mc_opts</strong> (<em>dict</em>) – Monte Carlo simulation options.</p></li>
<li><p><strong>wav_opts</strong> (<em>dict</em>) – Weighted average calculation and plotting options.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>results</strong> – Age and uncertainty results.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.dqpb.pbu_iterative">
<span class="sig-prename descclassname"><span class="pre">pysoplot.dqpb.</span></span><span class="sig-name descname"><span class="pre">pbu_iterative</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ThU_melt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Th232_U238</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Pb208_206</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">D_PaU</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">age_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'206Pb*'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxiter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-08</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.dqpb.pbu_iterative" title="Permalink to this definition"></a></dt>
<dd><p>Compute disequilibrium 206Pb*/U238 or 207Pb-corrected ages iteratively.
Either (232Th/238U)i is inferred from measured 232Th/238U, or from
radiogenic 208Pb/206Pb and age.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>ndarray</em><em> (</em><em>1-D</em><em>, </em><em>2-D</em><em>)</em>) – Either measured 206Pb*/238U for each aliquot (for 206Pb* age),
or measured 238U/206Pb and 207Pb/206Pb (for 207Pb-corrected age).</p></li>
<li><p><strong>ThU_melt</strong> (<em>ndarray</em><em> (</em><em>1-D</em><em>)</em>) – Th/U ratio of the melt.</p></li>
<li><p><strong>Th232_U238</strong> (<em>ndarray</em><em> (</em><em>1-D</em><em>)</em>) – Measured 232Th/238U for each aliquot.</p></li>
<li><p><strong>Pb208_206</strong> (<em>ndarray</em><em> (</em><em>1-D</em><em>)</em>) – Measured radiogenic 208Pb/206Pb for each aliquot.</p></li>
<li><p><strong>D_PaU</strong> (<em>float</em><em>, </em><em>optional</em>) – Ratio of mineral-melt distribution coefficients, DPu/DU.</p></li>
<li><p><strong>alpha</strong> (<em>float</em>) – Common 207Pb/206Pb ratio.</p></li>
<li><p><strong>t0</strong> (<em>float</em><em>, </em><em>optional</em>) – Age guess.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference internal" href="#pysoplot.exceptions.ConvergenceError" title="pysoplot.exceptions.ConvergenceError"><strong>exceptions.ConvergenceError</strong></a> – If no convergent age solution is found.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.dqpb.pbu_iterative_age">
<span class="sig-prename descclassname"><span class="pre">pysoplot.dqpb.</span></span><span class="sig-name descname"><span class="pre">pbu_iterative_age</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Vx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ThU_melt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ThU_melt_1s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Pb208_206</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">V_Pb208_206</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Th232_U238</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">V_Th232_U238</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">DPaU</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">DPaU_1s</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha_1s</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">age_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'206Pb*'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uncert</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'analytical'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rand</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wav</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wav_opts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mc_opts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.dqpb.pbu_iterative_age" title="Permalink to this definition"></a></dt>
<dd><p>Compute disequilibrium 206Pb*/U238 or 207Pb-corrected ages iteratively
along with age uncertainties. Either initial Th/U_min can be inferred from
measured 232Th/238U, or from radiogenic 208Pb/206Pb and age.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>ndarray</em><em> (</em><em>1-D</em><em>, </em><em>2-D</em><em>)</em>) – Either a 1 x n array of measured 206Pb*/238U for each aliquot (for
206Pb* age), or 2 x n array of measured 238U/206Pb and 207Pb/206Pb (for
207Pb-corrected age).</p></li>
<li><p><strong>Vx</strong> (<em>ndarray</em><em> (</em><em>2-D</em><em>)</em>) – Covariance matrix of uncertainties on measured isotope ratios. This
should be an n x n array for 206Pb* and 207Pb* ages, or a 2n x 2n array
for 207Pb-corrected ages.</p></li>
<li><p><strong>ThU_melt</strong> (<em>float</em>) – Th/U ratio of the melt.</p></li>
<li><p><strong>ThU_melt_1s</strong> (<em>float</em>) – Uncertainty on Th/U ratio of the melt (1 sigma).</p></li>
<li><p><strong>Th232_U238</strong> (<em>ndarray</em><em> (</em><em>1-D</em><em>)</em><em>, </em><em>optional</em>) – Measured 232Th/238U for each aliquot.</p></li>
<li><p><strong>V_Th232_U238</strong> (<em>ndarray</em><em> (</em><em>2-D</em><em>)</em><em>, </em><em>optional</em>) – Covariance matrix of uncertainties on measured 232Th/238U.</p></li>
<li><p><strong>Pb208_206</strong> (<em>ndarray</em><em> (</em><em>1-D</em><em>)</em>) – Measured radiogenic 208Pb/206Pb for each aliquot.</p></li>
<li><p><strong>V_Pb208_206</strong> (<em>ndarray</em><em> (</em><em>2-D</em><em>)</em><em>:</em>) – Covariance matrix of uncertainties on radiogenic 208Pb/206Pb values.</p></li>
<li><p><strong>DPaU</strong> (<em>float</em><em>, </em><em>optional</em>) – Ratio of mineral-melt distribution coefficients, DPu/DU.</p></li>
<li><p><strong>DPaU_1s</strong> (<em>float</em><em>, </em><em>optional</em>) – Uncertainty on ratio of mineral-melt distribution coefficients, DPu/DU.</p></li>
<li><p><strong>alpha</strong> (<em>float</em><em>, </em><em>optional</em>) – Common 207Pb/206Pb ratio.</p></li>
<li><p><strong>alpha_1s</strong> (<em>float</em><em>, </em><em>optional</em>) – Uncertainty on common 207Pb/206Pb ratio.</p></li>
<li><p><strong>t0</strong> (<em>ndarray</em><em> or </em><em>float</em><em>, </em><em>optional</em>) – Age guess(es).</p></li>
<li><p><strong>uncert</strong> (<em>{'mc'</em><em>, </em><em>'analytical'}</em><em>, </em><em>optional</em>) – Method of propagating age uncertainties.</p></li>
<li><p><strong>rand</strong> (<em>bool</em>) – If true, compute random only uncertainties as well as total
uncertainties (e.g., for plotting error bars).</p></li>
<li><p><strong>mc_opts</strong> (<em>dict</em>) – Monte Carlo simulation options.</p></li>
<li><p><strong>wav_opts</strong> (<em>dict</em>) – Weighted average calculation and plotting options.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>results</strong> – Age and uncertainty results.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.dqpb.pbu_iterative_uncert">
<span class="sig-prename descclassname"><span class="pre">pysoplot.dqpb.</span></span><span class="sig-name descname"><span class="pre">pbu_iterative_uncert</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ThU_min</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Vx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ThU_melt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ThU_melt_1s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Th232_U238</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">V_Th232_U238</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Pb208_206</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">V_Pb208_206</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha_1s</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">age_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'206Pb*'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.dqpb.pbu_iterative_uncert" title="Permalink to this definition"></a></dt>
<dd><p>Compute uncertainties for a suite of co-genetic disequilibrium 206Pb*/238U,
207Pb*/235U or 207Pb-corrected ages using analytical error propagation.
ThU_min is either computed from measured 232Th/238U, or computed numerically
from radiogenic 208Pb/206Pb and age.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t</strong> (<em>ndarray</em><em> (</em><em>1-D</em><em>)</em>) – Ages.</p></li>
<li><p><strong>ThU_min</strong> (<em>ndarray</em><em> (</em><em>1-D</em><em>)</em>) – (Th/U)_min. solutions.</p></li>
<li><p><strong>x</strong> (<em>ndarray</em><em> (</em><em>1-D</em><em>, </em><em>2-D</em><em>)</em>) – Measured isotope ratios. This should be a 1-D array for 206Pb* and
207Pb* ages, or a 2 x n array for 207Pb-corrected ages.</p></li>
<li><p><strong>Vx</strong> (<em>ndarray</em><em> (</em><em>2-D</em><em>)</em>) – Covariance matrix of uncertainties on measured isotope ratios. This
should be an n x n array for 206Pb* and 207Pb* ages, or a 2n x 2n array
for 207Pb-corrected ages.</p></li>
<li><p><strong>ThU_melt</strong> (<em>float</em>) – Th/U ratio of the melt.</p></li>
<li><p><strong>ThU_melt_1s</strong> (<em>float</em>) – Uncertainty (1 sigma) on Th/U ratio of the melt.</p></li>
<li><p><strong>Pb208_206</strong> (<em>ndarray</em><em> (</em><em>1-D</em><em>)</em><em>, </em><em>optional</em>) – Radiogenic 208Pb/206Pb ratios.</p></li>
<li><p><strong>V_Pb208_206</strong> (<em>ndarray</em><em> (</em><em>2-D</em><em>)</em><em>, </em><em>optional</em>) – Covariance matrix for radiogenic 208Pb/206Pb ratios.</p></li>
<li><p><strong>Th232_U238</strong> (<em>ndarray</em><em>, </em><em>optional</em>) – Measured 232Th/238U ratio.</p></li>
<li><p><strong>V_Th232_U238</strong> (<em>ndarray</em><em>, </em><em>optional</em>) – Covariance matrix for measured 232Th/238U ratios.</p></li>
<li><p><strong>alpha</strong> (<em>float</em><em>, </em><em>optional</em>) – Common 207Pb/206Pb ratio.</p></li>
<li><p><strong>alpha_1s</strong> (<em>float</em><em>, </em><em>optional</em>) – Uncertainty (1 sigma) on common 207Pb/206Pb ratio.</p></li>
<li><p><strong>age_type</strong> (<em>{'206Pb*'</em><em>, </em><em>'207Pb*'</em><em>, </em><em>'cor207Pb'}</em>) – Age type to calculate uncertainties for.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>Vt</strong> – Covariance matrix of ages.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray (2-D)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.dqpb.pbu_uncert">
<span class="sig-prename descclassname"><span class="pre">pysoplot.dqpb.</span></span><span class="sig-name descname"><span class="pre">pbu_uncert</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Vx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a230_238</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a231_235</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">V_a230_238</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">V_a231_235</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha_1s</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">age_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'206Pb*'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.dqpb.pbu_uncert" title="Permalink to this definition"></a></dt>
<dd><p>Compute uncertainties for a suite of disequilibrium 206Pb*/238U,
207Pb*/235U or 207Pb-corrected ages using analytical error propagation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>ndarray</em><em> (</em><em>1-D</em><em>, </em><em>2-D</em><em>)</em>) – Measured isotope ratios. This should be a 1-D array for 206Pb* and
207Pb* ages, or a 2 x n array for 207Pb-corrected ages.</p></li>
<li><p><strong>Vx</strong> (<em>ndarray</em><em> (</em><em>2-D</em><em>)</em>) – Covariance matrix of uncertainties on measured isotope ratios. This
should be an n x n array for 206Pb* and 207Pb* ages, or a 2n x 2n array
for 207Pb-corrected ages.</p></li>
<li><p><strong>a230_238</strong> (<em>ndarray</em><em> (</em><em>1-D</em><em>)</em><em>, </em><em>optional</em>) – Initial [230Th/238U] activity ratios.</p></li>
<li><p><strong>V_a230_238</strong> (<em>ndarray</em><em> (</em><em>2-D</em><em>)</em><em>, </em><em>optional</em>) – Covariance matrix of initial [230Th/238U] uncertainties.</p></li>
<li><p><strong>a231_235</strong> (<em>ndarray</em><em> (</em><em>1-D</em><em>)</em><em>, </em><em>optional</em>) – Initial [231Pa/235U] activity ratios.</p></li>
<li><p><strong>V_a231_235</strong> (<em>ndarray</em><em> (</em><em>2-D</em><em>)</em><em>, </em><em>optional</em>) – Covariance matrix of initial [231Pa/235U] uncertainties.</p></li>
<li><p><strong>alpha</strong> (<em>float</em><em>, </em><em>optional</em>) – Common 207Pb/206Pb ratio.</p></li>
<li><p><strong>alpha_1s</strong> (<em>float</em><em>, </em><em>optional</em>) – Uncertainty (1 sigma) on common 207Pb/206Pb ratio.</p></li>
<li><p><strong>age_type</strong> (<em>{'206Pb*'</em><em>, </em><em>'207Pb*'</em><em>, </em><em>'cor207Pb'}</em>) – Age type to calculate uncertainties for.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>Vt</strong> – Covariance matrix of ages.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray (2-D)</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-pysoplot.exceptions">
<span id="pysoplot-exceptions-module"></span><h2>pysoplot.exceptions module<a class="headerlink" href="#module-pysoplot.exceptions" title="Permalink to this heading"></a></h2>
<p>Custom exceptions.</p>
<dl class="py exception">
<dt class="sig sig-object py" id="pysoplot.exceptions.ConvergenceError">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pysoplot.exceptions.</span></span><span class="sig-name descname"><span class="pre">ConvergenceError</span></span><a class="headerlink" href="#pysoplot.exceptions.ConvergenceError" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
<p>Exception raised when a numerical routine fails to meet convergence
criterion.</p>
</dd></dl>

</section>
<section id="module-pysoplot.guillong">
<span id="pysoplot-guillong-module"></span><h2>pysoplot.guillong module<a class="headerlink" href="#module-pysoplot.guillong" title="Permalink to this heading"></a></h2>
<p>Pb/U equations assuming disequilibrium in a single nuclide only.</p>
<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.guillong.f">
<span class="sig-prename descclassname"><span class="pre">pysoplot.guillong.</span></span><span class="sig-name descname"><span class="pre">f</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fThU</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.guillong.f" title="Permalink to this definition"></a></dt>
<dd><p>206Pb/238U atomic ratio as a function of time and actvitiy
ratios using equation from Guillong et al. (2014).</p>
<p class="rubric">Notes</p>
<p>This equation assumes that 226Ra is always in radioactive
equilibrium with 230Th. Where [226Ra/238U]i does not equal [230Th/238U]i,
this equation may be inaccurate.</p>
<p class="rubric">References</p>
<p>Guillong, M., von Quadt, A., Sakata, S., Peytcheva, I., Bachmann, O., 2014.
LA-ICP-MS Pb-U dating of young zircons from the Kos–Nisyros volcanic centre,
SE aegean arc. Journal of Analytical Atomic Spectrometry 29, 963–970.
<a class="reference external" href="https://doi.org/10.1039/C4JA00009A">https://doi.org/10.1039/C4JA00009A</a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.guillong.g">
<span class="sig-prename descclassname"><span class="pre">pysoplot.guillong.</span></span><span class="sig-name descname"><span class="pre">g</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fPaU</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.guillong.g" title="Permalink to this definition"></a></dt>
<dd><p>207Pb/235U atomic ratio as a function of time and actvitiy
ratios using equation from Sakata et al. (2018).</p>
<p class="rubric">References</p>
<p>Sakata, S., Hirakawa, S., Iwano, H., Danhara, T., Guillong, M., Hirata, T.,
2017. A new approach for constraining the magnitude of initial
disequilibrium in Quaternary zircons by coupled uranium and thorium decay
series dating. Quaternary Geochronology 38, 1–12.
<a class="reference external" href="https://doi.org/10.1016/j.quageo.2016.11.002">https://doi.org/10.1016/j.quageo.2016.11.002</a></p>
</dd></dl>

</section>
<section id="module-pysoplot.isochron">
<span id="pysoplot-isochron-module"></span><h2>pysoplot.isochron module<a class="headerlink" href="#module-pysoplot.isochron" title="Permalink to this heading"></a></h2>
<p>“Classical” isochron ages.</p>
<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.isochron.age">
<span class="sig-prename descclassname"><span class="pre">pysoplot.isochron.</span></span><span class="sig-name descname"><span class="pre">age</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">age_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'iso-206Pb'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dc_errors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.isochron.age" title="Permalink to this definition"></a></dt>
<dd><p>Calculate classical isochron age.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>b</strong> (<em>float</em>) – Linear regression slope</p></li>
<li><p><strong>sb</strong> (<em>float</em><em>, </em><em>optional</em>) – Uncertaintiy in regression slope (<span class="math notranslate nohighlight">\(1\sigma\)</span>)</p></li>
<li><p><strong>age_type</strong> (<em>{'iso-Pb6U8'</em><em>, </em><em>'iso-Pb7U5'}</em>) – Isochron age type.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.isochron.mc_uncert">
<span class="sig-prename descclassname"><span class="pre">pysoplot.isochron.</span></span><span class="sig-name descname"><span class="pre">mc_uncert</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fit</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">age_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'iso-206Pb'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dc_errors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_isotope</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'204Pb'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trials</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hist</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.isochron.mc_uncert" title="Permalink to this definition"></a></dt>
<dd><p>Compute classical isochron age uncertainties using Monte Carlo approach.</p>
<p>Compute Monte Carlo age uncertainties for equilibrium concordia intercept
age.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fit</strong> (<em>dict</em>) – Linear regression fit parameters.</p></li>
<li><p><strong>age_type</strong> (<em>{'iso-Pb6U8'</em><em>, </em><em>'iso-Pb7U5'}</em>) – Isochron age type.</p></li>
<li><p><strong>trials</strong> (<em>int</em>) – Number of Monte Carlo trials.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-pysoplot.ludwig">
<span id="pysoplot-ludwig-module"></span><h2>pysoplot.ludwig module<a class="headerlink" href="#module-pysoplot.ludwig" title="Permalink to this heading"></a></h2>
<p>Disequilibrium U-Pb equations based on Ludwig (1977).</p>
<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.ludwig.bateman">
<span class="sig-prename descclassname"><span class="pre">pysoplot.ludwig.</span></span><span class="sig-name descname"><span class="pre">bateman</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Lam</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">series</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'238U'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.ludwig.bateman" title="Permalink to this definition"></a></dt>
<dd><p>Return Bateman coefficients for the 238U or 235U decay series as defined in
Ludwig (1977).</p>
<dl class="simple">
<dt>Lam<span class="classifier">array-like</span></dt><dd><p>array of relevant decay constants (see below)</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p class="rubric">References</p>
<p>Ludwig, K.R., 1977. Effect of initial radioactive-daughter disequilibrium
on U-Pb isotope apparent ages of young minerals. Journal of Research of
the US Geological Survey 5, 663–667.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.ludwig.dfdt">
<span class="sig-prename descclassname"><span class="pre">pysoplot.ludwig.</span></span><span class="sig-name descname"><span class="pre">dfdt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Lam</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coef</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(True,</span> <span class="pre">True)</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.ludwig.dfdt" title="Permalink to this definition"></a></dt>
<dd><p>Derivative of 206Pb*/238U ratio (where * denotes radiogenic Pb) with
respect to t.</p>
<p class="rubric">Notes</p>
<p>These equations are based on secular equilibrium U-series equations only at
present.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.ludwig.dfdt_comp">
<span class="sig-prename descclassname"><span class="pre">pysoplot.ludwig.</span></span><span class="sig-name descname"><span class="pre">dfdt_comp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Lam</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coef</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(True,</span> <span class="pre">True)</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.ludwig.dfdt_comp" title="Permalink to this definition"></a></dt>
<dd><p>Individual components of derivative of 206Pb*/238U ratio (where * denotes
radiogenic Pb) with respect to t.</p>
<p class="rubric">Notes</p>
<p>These equations are based on secular equilibrium U-series equations only at
present.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.ludwig.dgdt">
<span class="sig-prename descclassname"><span class="pre">pysoplot.ludwig.</span></span><span class="sig-name descname"><span class="pre">dgdt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a231_235_i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Lam</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coef</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.ludwig.dgdt" title="Permalink to this definition"></a></dt>
<dd><p>Derivative of 207Pb*/235U (where * denotes radiogenic Pb) with respect to
t.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.ludwig.dgdt_comp">
<span class="sig-prename descclassname"><span class="pre">pysoplot.ludwig.</span></span><span class="sig-name descname"><span class="pre">dgdt_comp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a231_235_i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Lam</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coef</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.ludwig.dgdt_comp" title="Permalink to this definition"></a></dt>
<dd><p>Individual components of derivative of 207Pb*/235U (where * denotes
radiogenic Pb) with respect to t.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.ludwig.f">
<span class="sig-prename descclassname"><span class="pre">pysoplot.ludwig.</span></span><span class="sig-name descname"><span class="pre">f</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Lam</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coef</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(True,</span> <span class="pre">True)</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.ludwig.f" title="Permalink to this definition"></a></dt>
<dd><p>206Pb*/238U ratio (where * denotes radiogenic Pb) as a function of t and
activity ratio values following Ludwig (1977). Note there is a small typo
in the original Ludwig article.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t</strong> (<em>float</em><em> or </em><em>array-like</em>) – Age (Ma)</p></li>
<li><p><strong>A</strong> (<em>array-like</em>) – One-dimensional array of activity ratio values arranged as follows
[234U/238U], [230Th/238U], [226Ra/238U],</p></li>
<li><p><strong>Lam</strong> (<em>array-like</em>) – One-dimensional array of decay constants (Ma^-1) arragend as follows
[lam238, lam234, lam230, lam226]</p></li>
<li><p><strong>coef</strong> (<em>array-like</em>) – One-dimensional array of Bateman coefficients
[c1, c2, c3, c4, c5, p1, p2, p3, h1, h2]</p></li>
<li><p><strong>init</strong> (<em>array-like</em><em>, </em><em>optional</em>) – Two element array of bools. First element is True if [234U/238U] is
an initial value. Second element is True if [230Th/238U] is an initial
value.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">References</p>
<p>Ludwig, K.R., 1977. Effect of initial radioactive-daughter disequilibrium
on U-Pb isotope apparent ages of young minerals. Journal of Research of
the US Geological Survey 5, 663–667.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.ludwig.f_comp">
<span class="sig-prename descclassname"><span class="pre">pysoplot.ludwig.</span></span><span class="sig-name descname"><span class="pre">f_comp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Lam</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coef</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(True,</span> <span class="pre">True)</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.ludwig.f_comp" title="Permalink to this definition"></a></dt>
<dd><p>Return individual components of f.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.ludwig.g">
<span class="sig-prename descclassname"><span class="pre">pysoplot.ludwig.</span></span><span class="sig-name descname"><span class="pre">g</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a231_235_i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Lam</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coef</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.ludwig.g" title="Permalink to this definition"></a></dt>
<dd><p>207Pb*/235U  ratio (where * denotes radiogenic Pb) as a function of t and
activity ratio values following Ludwig (1977).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t</strong> (<em>float</em><em> or </em><em>array-like</em>) – Age (Ma)</p></li>
<li><p><strong>a231_235_i</strong> (<em>float</em><em> or </em><em>array-like</em>) – [231Pa/235U] activity ratio.</p></li>
<li><p><strong>Lam</strong> (<em>array-like</em>) – One-dimensional array of decay constants (Ma^-1) arragend as follows
[lam235, lam231]</p></li>
<li><p><strong>coef</strong> (<em>array-like</em>) – One-dimensional array of Bateman coefficients
[d1, d2]</p></li>
</ul>
</dd>
</dl>
<p class="rubric">References</p>
<p>Ludwig, K.R., 1977. Effect of initial radioactive-daughter disequilibrium
on U-Pb isotope apparent ages of young minerals. Journal of Research of
the US Geological Survey 5, 663–667.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.ludwig.g_comp">
<span class="sig-prename descclassname"><span class="pre">pysoplot.ludwig.</span></span><span class="sig-name descname"><span class="pre">g_comp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a231_235_i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Lam</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coef</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.ludwig.g_comp" title="Permalink to this definition"></a></dt>
<dd><p>Return individual components of g.</p>
</dd></dl>

</section>
<section id="module-pysoplot.minimise">
<span id="pysoplot-minimise-module"></span><h2>pysoplot.minimise module<a class="headerlink" href="#module-pysoplot.minimise" title="Permalink to this heading"></a></h2>
<p>Minimisation functions for numerical disequilibrium age solutions.</p>
<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.minimise.concage_x">
<span class="sig-prename descclassname"><span class="pre">pysoplot.minimise.</span></span><span class="sig-name descname"><span class="pre">concage_x</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">diagram</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(False,</span> <span class="pre">False)</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.minimise.concage_x" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.minimise.concint">
<span class="sig-prename descclassname"><span class="pre">pysoplot.minimise.</span></span><span class="sig-name descname"><span class="pre">concint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">diagram</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'tw'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(True,</span> <span class="pre">True)</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.minimise.concint" title="Permalink to this definition"></a></dt>
<dd><p>Disequilbrium concordia-intercept age minimisation function.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.minimise.concordant_A48">
<span class="sig-prename descclassname"><span class="pre">pysoplot.minimise.</span></span><span class="sig-name descname"><span class="pre">concordant_A48</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.minimise.concordant_A48" title="Permalink to this definition"></a></dt>
<dd><p>Minimisation function for computing initial U234/U238 activity ratio that
forces concordance between 238U and 235U isochron ages.</p>
<p>Minimises function: f(t75, A) - slope_86, where t75 is
the 207Pb/x-235U/x isochron age.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.minimise.guillong">
<span class="sig-prename descclassname"><span class="pre">pysoplot.minimise.</span></span><span class="sig-name descname"><span class="pre">guillong</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.minimise.guillong" title="Permalink to this definition"></a></dt>
<dd><p>Minimisation function for disequilibrium Pb/U ages using the equations of
Guillong et al., (2014) - eith 206Pb/238U or 207Pb/235U ages.
fXU is either fThU or fPaU</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lam235</strong> (<em>lamU is either lam238 or</em>) – </p></li>
<li><p><strong>lam231</strong> (<em>lamX is either lam230 or</em>) – </p></li>
</ul>
</dd>
</dl>
<p class="rubric">References</p>
<p>Guillong, M., von Quadt, A., Sakata, S., Peytcheva, I., Bachmann, O., 2014.
LA-ICP-MS Pb-U dating of young zircons from the Kos–Nisyros volcanic centre,
SE aegean arc. Journal of Analytical Atomic Spectrometry 29, 963–970.
<a class="reference external" href="https://doi.org/10.1039/C4JA00009A">https://doi.org/10.1039/C4JA00009A</a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.minimise.isochron">
<span class="sig-prename descclassname"><span class="pre">pysoplot.minimise.</span></span><span class="sig-name descname"><span class="pre">isochron</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">age_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'iso-206Pb'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(True,</span> <span class="pre">True)</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.minimise.isochron" title="Permalink to this definition"></a></dt>
<dd><p>Disequilibrium isochron age minimisation function.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.minimise.pbu">
<span class="sig-prename descclassname"><span class="pre">pysoplot.minimise.</span></span><span class="sig-name descname"><span class="pre">pbu</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">age_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'206Pb*'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(True,</span> <span class="pre">True)</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.minimise.pbu" title="Permalink to this definition"></a></dt>
<dd><p>Age minimisation function for disequilibrium Pb*/U and
207Pb-corrected ages.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.minimise.pbu_iterative">
<span class="sig-prename descclassname"><span class="pre">pysoplot.minimise.</span></span><span class="sig-name descname"><span class="pre">pbu_iterative</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">age_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'206Pb*'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">meas_232Th_238U</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.minimise.pbu_iterative" title="Permalink to this definition"></a></dt>
<dd><p>Age functions for disequilibrium 206Pb*/U238 ages computed
iteratively. Either (232Th/238U)i is inferred from measured 232Th/238U, or
from radiogenic 208Pb/206Pb and age.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.minimise.sakata">
<span class="sig-prename descclassname"><span class="pre">pysoplot.minimise.</span></span><span class="sig-name descname"><span class="pre">sakata</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.minimise.sakata" title="Permalink to this definition"></a></dt>
<dd><p>Pb/U age minimisation functions using equaitons of Sakata (2017).</p>
<p class="rubric">References</p>
<p>Sakata, S., Hirakawa, S., Iwano, H., Danhara, T., Guillong, M., Hirata, T.,
2017. A new approach for constraining the magnitude of initial
disequilibrium in Quaternary zircons by coupled uranium and thorium decay
series dating. Quaternary Geochronology 38, 1–12.
<a class="reference external" href="https://doi.org/10.1016/j.quageo.2016.11.002">https://doi.org/10.1016/j.quageo.2016.11.002</a></p>
</dd></dl>

</section>
<section id="module-pysoplot.misc">
<span id="pysoplot-misc-module"></span><h2>pysoplot.misc module<a class="headerlink" href="#module-pysoplot.misc" title="Permalink to this heading"></a></h2>
<p>Miscellaneous functions.</p>
<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.misc.cdiff">
<span class="sig-prename descclassname"><span class="pre">pysoplot.misc.</span></span><span class="sig-name descname"><span class="pre">cdiff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.misc.cdiff" title="Permalink to this definition"></a></dt>
<dd><p>Estimate derivative using central difference method.</p>
<p class="rubric">Notes</p>
<p>The result is quite sensitive to the h value chosen. A suitable h is
difficult to determine a priori, but often 1e-08    imes x is a reasonable
guess.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.misc.compile_vxy">
<span class="sig-prename descclassname"><span class="pre">pysoplot.misc.</span></span><span class="sig-name descname"><span class="pre">compile_vxy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rxy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.misc.compile_vxy" title="Permalink to this definition"></a></dt>
<dd><p>Compile full covariance matrix for 2-D data points.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.misc.covmat_to_cormat">
<span class="sig-prename descclassname"><span class="pre">pysoplot.misc.</span></span><span class="sig-name descname"><span class="pre">covmat_to_cormat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cov</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.misc.covmat_to_cormat" title="Permalink to this definition"></a></dt>
<dd><p>Compute correlation matrix from covariance matrix. Based on:
<a class="reference external" href="https://gist.github.com/wiso/ce2a9919ded228838703c1c7c7dad13b">https://gist.github.com/wiso/ce2a9919ded228838703c1c7c7dad13b</a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.misc.eigsorted">
<span class="sig-prename descclassname"><span class="pre">pysoplot.misc.</span></span><span class="sig-name descname"><span class="pre">eigsorted</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cov</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.misc.eigsorted" title="Permalink to this definition"></a></dt>
<dd><p>Return eigenvalues and vectors sorted from largest to smallest.
Based on code by Joe Kington:
<a class="reference external" href="https://github.com/joferkington/oost_paper_code/blob/master/error_ellipse.py">https://github.com/joferkington/oost_paper_code/blob/master/error_ellipse.py</a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.misc.get_exponent">
<span class="sig-prename descclassname"><span class="pre">pysoplot.misc.</span></span><span class="sig-name descname"><span class="pre">get_exponent</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.misc.get_exponent" title="Permalink to this definition"></a></dt>
<dd><p>Return order of magnitude of n</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.misc.num_dec_places">
<span class="sig-prename descclassname"><span class="pre">pysoplot.misc.</span></span><span class="sig-name descname"><span class="pre">num_dec_places</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.misc.num_dec_places" title="Permalink to this definition"></a></dt>
<dd><p>Return number of decimal digits in string representation of a decimal
number.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.misc.pos_def">
<span class="sig-prename descclassname"><span class="pre">pysoplot.misc.</span></span><span class="sig-name descname"><span class="pre">pos_def</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-08</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.misc.pos_def" title="Permalink to this definition"></a></dt>
<dd><p>Verify that matrix is positive semi-definite.
Based on numpy multivariate_normal code, e.g.:
<a class="reference external" href="https://github.com/numpy/numpy/blob/main/numpy/random/mtrand.pyx">https://github.com/numpy/numpy/blob/main/numpy/random/mtrand.pyx</a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.misc.print_result">
<span class="sig-prename descclassname"><span class="pre">pysoplot.misc.</span></span><span class="sig-name descname"><span class="pre">print_result</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dic</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Result'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.misc.print_result" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.misc.print_table">
<span class="sig-prename descclassname"><span class="pre">pysoplot.misc.</span></span><span class="sig-name descname"><span class="pre">print_table</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cols</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Table'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.misc.print_table" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.misc.round_down">
<span class="sig-prename descclassname"><span class="pre">pysoplot.misc.</span></span><span class="sig-name descname"><span class="pre">round_down</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.misc.round_down" title="Permalink to this definition"></a></dt>
<dd><p>Round float down to n significant figures.</p>
</dd></dl>

</section>
<section id="pysoplot-monte-carlo-module">
<h2>pysoplot.monte_carlo module<a class="headerlink" href="#pysoplot-monte-carlo-module" title="Permalink to this heading"></a></h2>
</section>
<section id="module-pysoplot.plotting">
<span id="pysoplot-plotting-module"></span><h2>pysoplot.plotting module<a class="headerlink" href="#module-pysoplot.plotting" title="Permalink to this heading"></a></h2>
<p>Plotting routines and functions.</p>
<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.plotting.apply_plot_settings">
<span class="sig-prename descclassname"><span class="pre">pysoplot.plotting.</span></span><span class="sig-name descname"><span class="pre">apply_plot_settings</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fig</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'isochron'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diagram</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(None,</span> <span class="pre">None)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(None,</span> <span class="pre">None)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis_labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(None,</span> <span class="pre">None)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_isotope</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'204Pb'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.plotting.apply_plot_settings" title="Permalink to this definition"></a></dt>
<dd><p>Set axis labels and limits. Apply label, tick, grid formatting settings as
defined in pysoplot.cfg.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fig</strong> (<em>matplotlib.pyplot.Figure</em>) – Figure to apply settings to.</p></li>
<li><p><strong>plot_type</strong> (<em>{'isochron'</em><em>, </em><em>'intercept'</em><em>, </em><em>'wav'</em><em>, </em><em>'hist'}</em><em>, </em><em>optional</em>) – Plot type.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.plotting.box_line_intersection">
<span class="sig-prename descclassname"><span class="pre">pysoplot.plotting.</span></span><span class="sig-name descname"><span class="pre">box_line_intersection</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xmin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xmax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ymin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ymax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.plotting.box_line_intersection" title="Permalink to this definition"></a></dt>
<dd><p>Find intercpet points between line defined by slope = a, int = b, and
axis window limits.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.plotting.confidence_ellipse">
<span class="sig-prename descclassname"><span class="pre">pysoplot.plotting.</span></span><span class="sig-name descname"><span class="pre">confidence_ellipse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_xy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.95</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mpl_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'data</span> <span class="pre">ellipse'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ellipse_kw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outline_alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.plotting.confidence_ellipse" title="Permalink to this definition"></a></dt>
<dd><p>Plot 2D correlated data point as covariance ellipse. Assumes large
sample size was used to estimate data point uncertainties and covariance.</p>
<p>Based partly on code implemented in Knighton and Tobin (2011), see:
<a class="reference external" href="https://github.com/joferkington/oost_paper_code/blob/master/error_ellipse.py">https://github.com/joferkington/oost_paper_code/blob/master/error_ellipse.py</a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.plotting.in_box">
<span class="sig-prename descclassname"><span class="pre">pysoplot.plotting.</span></span><span class="sig-name descname"><span class="pre">in_box</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xmin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xmax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ymin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ymax</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.plotting.in_box" title="Permalink to this definition"></a></dt>
<dd><p>Check if point p = (x, y) is within bounding rectangle
defined by x, y limits, allowing some tolerance for floating points numbers.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.plotting.line_intersection">
<span class="sig-prename descclassname"><span class="pre">pysoplot.plotting.</span></span><span class="sig-name descname"><span class="pre">line_intersection</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">L2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.plotting.line_intersection" title="Permalink to this definition"></a></dt>
<dd><p>Return intersection point between line defined by slope, b1, and y-int,
a1, and a line segment defined by end points as L2 = ((x1, y1), (x2, y2)).</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.plotting.oned_dp">
<span class="sig-prename descclassname"><span class="pre">pysoplot.plotting.</span></span><span class="sig-name descname"><span class="pre">oned_dp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xpm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rand_pm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sorted</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.plotting.oned_dp" title="Permalink to this definition"></a></dt>
<dd><p>Plot 1-d data points (e.g. ages used to compute weighted mean).</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.plotting.plot_cor207_projection">
<span class="sig-prename descclassname"><span class="pre">pysoplot.plotting.</span></span><span class="sig-name descname"><span class="pre">plot_cor207_projection</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_xy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Pb76</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">A</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.plotting.plot_cor207_projection" title="Permalink to this definition"></a></dt>
<dd><p>Plot projection line from the common 207Pb/206Pb value through the center
of the data ellipse. If t is supplied, then the line will be projected to the
concordia intercept. Otherwise, it will continue to the edge of the plot.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>t</strong> (<em>array-like</em><em>, </em><em>optional</em>) – Intercept age for data point. Must be same length as x and y.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.plotting.plot_dp">
<span class="sig-prename descclassname"><span class="pre">pysoplot.plotting.</span></span><span class="sig-name descname"><span class="pre">plot_dp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_xy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.95</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reset_axis_limits</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.plotting.plot_dp" title="Permalink to this definition"></a></dt>
<dd><p>Plot 2-dimensional data points with assigned uncertainties as confidence
ellipses.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>np.ndarray</em>) – x values (as 1-dimensional array)</p></li>
<li><p><strong>sx</strong> (<em>np.ndarray</em>) – uncertainty on x at <span class="math notranslate nohighlight">\(1\sigma\)</span> abs.</p></li>
<li><p><strong>y</strong> (<em>np.ndarray</em>) – y values</p></li>
<li><p><strong>sy</strong> (<em>np.ndaray</em>) – uncertainty on y at <span class="math notranslate nohighlight">\(1\sigma\)</span> abs.</p></li>
<li><p><strong>r_xy</strong> (<em>np.ndarray</em>) – x-y correlation coefficient</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Assumes a large sample size was used to estimate data point uncertainties
and covariances.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.plotting.plot_rfit">
<span class="sig-prename descclassname"><span class="pre">pysoplot.plotting.</span></span><span class="sig-name descname"><span class="pre">plot_rfit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fit</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.plotting.plot_rfit" title="Permalink to this definition"></a></dt>
<dd><p>Plot regression line and uncertainty envelope about regression line
indicating 95% confidence limits on fit.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ax</strong> (<em>matplotlib.pyplot.Axes</em>) – Axes to plot fit to.</p></li>
<li><p><strong>fit</strong> (<em>dict</em>) – Linear regression fit results.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.plotting.renv">
<span class="sig-prename descclassname"><span class="pre">pysoplot.plotting.</span></span><span class="sig-name descname"><span class="pre">renv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fit</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.plotting.renv" title="Permalink to this definition"></a></dt>
<dd><p>Plot uncertainty envelope about regression line indicating 95% confidence
limits on fit. For classical regression fits, uses the approach of
Ludwig (1980), for non-classical fits uses Monte Carlo simulation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ax</strong> (<em>matplotlib.pyplot.Axes</em>) – Axes to plot to.</p></li>
<li><p><strong>fit</strong> (<em>dict</em>) – Linear regression fit results.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">References</p>
<p>Ludwig, K.R., 1980. Calculation of uncertainties of U-Pb
isotope data. Earth and Planetary Science Letters 212–202.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.plotting.renv_mc">
<span class="sig-prename descclassname"><span class="pre">pysoplot.plotting.</span></span><span class="sig-name descname"><span class="pre">renv_mc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fit</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.plotting.renv_mc" title="Permalink to this definition"></a></dt>
<dd><p>Use Monte Carlo simulation to plot regression error envelope.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.plotting.rline">
<span class="sig-prename descclassname"><span class="pre">pysoplot.plotting.</span></span><span class="sig-name descname"><span class="pre">rline</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.plotting.rline" title="Permalink to this definition"></a></dt>
<dd><p>Plot regression line.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ax</strong> (<em>matplotlib.pyplot.Axes</em>) – Axes to plot to.</p></li>
<li><p><strong>theta</strong> (<em>array-like</em>) – Array with y-intercept as first element and slope as second.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.plotting.set_axis_labels">
<span class="sig-prename descclassname"><span class="pre">pysoplot.plotting.</span></span><span class="sig-name descname"><span class="pre">set_axis_labels</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diagram</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'tw'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_isotope</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'204Pb'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis_labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(None,</span> <span class="pre">None)</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.plotting.set_axis_labels" title="Permalink to this definition"></a></dt>
<dd><p>Set axis x, y axis labels for default diagram types, or use inputted
axis labels.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.plotting.set_axis_limits">
<span class="sig-prename descclassname"><span class="pre">pysoplot.plotting.</span></span><span class="sig-name descname"><span class="pre">set_axis_limits</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ymin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ymax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.plotting.set_axis_limits" title="Permalink to this definition"></a></dt>
<dd><p>Set axis limits if user specified limits are supplied.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.plotting.tick_label_format">
<span class="sig-prename descclassname"><span class="pre">pysoplot.plotting.</span></span><span class="sig-name descname"><span class="pre">tick_label_format</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ticks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sci_limits</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">comma_sep_thousands</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'x'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.plotting.tick_label_format" title="Permalink to this definition"></a></dt>
<dd><p>Format plot tick labels.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ticks</strong> (<em>array-like</em>) – List of ticks.</p></li>
<li><p><strong>sci_limits</strong> (<em>array-like</em>) – Axis scientific notation exponent limits as [lower, upper]. If the
maximum axis value is greater than 10 ^ upper then scientific notation
is used for tick labels. An equivalent test is applied to the lower
limit.</p></li>
<li><p><strong>comma_sep_thousands</strong> (<em>bool</em>) – True if use comma to separate each 10^3 increment, e.g. “10,450”.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>tick_formatter</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>matplotlib.ticker.Formatter</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.plotting.wav_line">
<span class="sig-prename descclassname"><span class="pre">pysoplot.plotting.</span></span><span class="sig-name descname"><span class="pre">wav_line</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xbpm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">env</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.plotting.wav_line" title="Permalink to this definition"></a></dt>
<dd><p>Add weighted average line and error envelope to plot of 1-D data points.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.plotting.wav_plot">
<span class="sig-prename descclassname"><span class="pre">pysoplot.plotting.</span></span><span class="sig-name descname"><span class="pre">wav_plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xpm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xbpm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rand_pm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sorted</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(None,</span> <span class="pre">None)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_multiplier</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dp_labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.plotting.wav_plot" title="Permalink to this definition"></a></dt>
<dd><p>Plot weighted average as line and uncertainty band and data points as
uncertainty bars.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>np.ndarray</em>) – Values to be averaged as 1-dimensional array.</p></li>
<li><p><strong>xpm</strong> (<em>np.ndarray</em>) – Symmetrical +/- errors on x.</p></li>
<li><p><strong>xb</strong> (<em>float</em>) – Average value (x-bar).</p></li>
<li><p><strong>xbpm</strong> (<em>float</em>) – Symmetrical +/- error on xb.</p></li>
<li><p><strong>rand_pm</strong> (<em>np.ndarray</em><em>, </em><em>optional</em>) – Random symmetrical +/- errors on x.</p></li>
<li><p><strong>x_multiplier</strong> – Use for unit conversion (e.g. set to 1000 for Ma to ka conversion)</p></li>
<li><p><strong>dp_labels</strong> (<em>array-like</em><em>, </em><em>optional</em>) – Data point labels.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-pysoplot.regression">
<span id="pysoplot-regression-module"></span><h2>pysoplot.regression module<a class="headerlink" href="#module-pysoplot.regression" title="Permalink to this heading"></a></h2>
<p>Linear regression algorithms for 2-dimensional datasets.</p>
<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.regression.classical_fit">
<span class="sig-prename descclassname"><span class="pre">pysoplot.regression.</span></span><span class="sig-name descname"><span class="pre">classical_fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_xy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ca'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diagram</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">isochron</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(None,</span> <span class="pre">None)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(None,</span> <span class="pre">None)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis_labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(None,</span> <span class="pre">None)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_isotope</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dp_labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.regression.classical_fit" title="Permalink to this definition"></a></dt>
<dd><p>Fit a classical linear regression line to 2-dimensional data and optionally
create plot of the fit. If model is set to ‘ca’, then routine will emulate
default the protocols of Isoplot Ludwig (2012).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>np.ndarray</em>) – x values (as 1-dimensional array)</p></li>
<li><p><strong>sx</strong> (<em>np.ndarray</em>) – analytical uncertainty on x at <span class="math notranslate nohighlight">\(1\sigma\)</span> abs.</p></li>
<li><p><strong>y</strong> (<em>np.ndarray</em>) – y values</p></li>
<li><p><strong>sy</strong> (<em>np.ndaray</em>) – analytical uncertainty on y at <span class="math notranslate nohighlight">\(1\sigma\)</span> abs.</p></li>
<li><p><strong>r_xy</strong> (<em>np.ndarray</em>) – x-y correlation coefficient</p></li>
<li><p><strong>isochron</strong> (<em>bool</em><em>, </em><em>optional</em>) – If true and model is ‘ca’ then fits model 3 for excess scatter data
sets instead of model 2.</p></li>
<li><p><strong>model</strong> (<em>{'ca'</em><em>, </em><em>'c1'</em><em>, </em><em>'c2'</em><em>, </em><em>'c3'}</em>) – Regression model to fit to data.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p><cite>model</cite> should be one of</p>
<ul class="simple">
<li><p>‘ca’ fit ‘best’ model depending on MSWD of york fit; emulates Isoplot behaviour</p></li>
<li><p>‘c1’ standard York fit with analytical errors</p></li>
<li><p>‘c2’ model of McSaveney in Faure (1977), equivalent to Isoplot model 2</p></li>
<li><p>‘c3’ equivalent to Isoplot model 3</p></li>
</ul>
<section id="references">
<h3>References<a class="headerlink" href="#references" title="Permalink to this heading"></a></h3>
<p>Faure, G., 1977. Appendix 1: Fitting of isochrons for dating by the Rb-Sr
method, in: Principles of Isotope Geology. John Wiley and Sons, pp. 1–17.</p>
<p>Ludwig, K.R., 2012. Isoplot/Ex Version 3.75: A
Geochronological Toolkit for Microsoft Excel, Special Publication 4.
Berkeley Geochronology Center.</p>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.regression.huberu">
<span class="sig-prename descclassname"><span class="pre">pysoplot.regression.</span></span><span class="sig-name descname"><span class="pre">huberu</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xy_err</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">itmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">250</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.regression.huberu" title="Permalink to this definition"></a></dt>
<dd><p>Huber line-fitter with analytical errors discarded. Used for robust model
2 fit. Can take many iterations to converge, so set itmax quite high.</p>
<p>Original code by Roger Powell with some style modifications by TP.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>xy_err</strong> (<em>np.ndarray</em><em>, </em><em>optional</em>) – 3 x n array-like with elements sx, sy, r_xy (i.e. analytical
errors on x and y, and their correlation coefficient). Used
to ensure fit error is not less than average analytical error
following approach of Powell et al. (2002).</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Do not call this function directly, instead call robust_model_2.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.regression.lad">
<span class="sig-prename descclassname"><span class="pre">pysoplot.regression.</span></span><span class="sig-name descname"><span class="pre">lad</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.regression.lad" title="Permalink to this definition"></a></dt>
<dd><p>Fit least absolute deviation model of Sadovski (1974).</p>
<p class="rubric">Notes</p>
<p>Based on code by Roger Powell.</p>
<p class="rubric">References</p>
<p>Sadovski, A.N., 1974. Algorithm AS 74: L1-norm Fit of a Straight Line. Journal
of the Royal Statistical Society. Series C (Applied Statistics) 23,
244–248. <a class="reference external" href="https://doi.org/10.2307/2347013">https://doi.org/10.2307/2347013</a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.regression.lsq">
<span class="sig-prename descclassname"><span class="pre">pysoplot.regression.</span></span><span class="sig-name descname"><span class="pre">lsq</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.regression.lsq" title="Permalink to this definition"></a></dt>
<dd><p>Fit ordinary least-squares model</p>
<p class="rubric">Notes</p>
<p>Based on code by Roger Powell.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.regression.model_2">
<span class="sig-prename descclassname"><span class="pre">pysoplot.regression.</span></span><span class="sig-name descname"><span class="pre">model_2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.regression.model_2" title="Permalink to this definition"></a></dt>
<dd><p>Fit a model 2 regression line. The slope is the geometric mean of ordinary
least squares of y on x and the reciprocal of the ordinary least squares
of x on y (Powell et al., 2020).</p>
<p>Equivalent to Isoplot Model 2 fit which is based on the routine of
MacSaveney in Faure (1977) and uses the main York routine with weightings
set to: wx = 0., wy = 1 / b^2, p_xy = 0, to achieve the same result
iteratively.</p>
<p class="rubric">Notes</p>
<p>Use the york function for now with model set to “2” as this function does
not yet compute covtheta.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.regression.model_3">
<span class="sig-prename descclassname"><span class="pre">pysoplot.regression.</span></span><span class="sig-name descname"><span class="pre">model_3</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_xy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sy_excess0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mswd_tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">itmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">york_itmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">york_atol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-08</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">york_rtol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-08</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.regression.model_3" title="Permalink to this definition"></a></dt>
<dd><p>Fit a model 3 regression line that is equivalent to Isoplot model 3 Ludwig (2012).
Weights each point according to analytical errors, plus an extra component
of Gaussian distributed scatter in y (applied equally to each data point).
For each iteration this excess error in y is inflated and a new York fit
produced, until MSWD converges to 1.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>np.ndarray</em>) – x values (as 1-dimensional array)</p></li>
<li><p><strong>sx</strong> (<em>np.ndarray</em>) – analytical uncertainty on x at <span class="math notranslate nohighlight">\(1\sigma\)</span> abs.</p></li>
<li><p><strong>y</strong> (<em>np.ndarray</em>) – y values</p></li>
<li><p><strong>sy</strong> (<em>np.ndaray</em>) – analytical uncertainty on y at <span class="math notranslate nohighlight">\(1\sigma\)</span> abs.</p></li>
<li><p><strong>r_xy</strong> (<em>np.ndarray</em>) – x-y correlation coefficient</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>In Isoplot, this is only used for classical isochron ages</p>
<p>When applying this algorithm,there should be a good justification for the
assumption of <strong>Guassian</strong> distributed excess scatter.</p>
<p class="rubric">References</p>
<p>Ludwig, K.R., 2012. Isoplot/Ex Version 3.75: A Geochronological Toolkit for
Microsoft Excel, Special Publication 4. Berkeley Geochronology Center.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.regression.robust_fit">
<span class="sig-prename descclassname"><span class="pre">pysoplot.regression.</span></span><span class="sig-name descname"><span class="pre">robust_fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_xy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ra'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diagram</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(None,</span> <span class="pre">None)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(None,</span> <span class="pre">None)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis_labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(None,</span> <span class="pre">None)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_isotope</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'204Pb'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dp_labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.regression.robust_fit" title="Permalink to this definition"></a></dt>
<dd><p>Fit a robust linear regression to 2-dimensional data and optionally create
a plot of the fit.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>np.ndarray</em>) – x values (as 1-dimensional array)</p></li>
<li><p><strong>sx</strong> (<em>np.ndarray</em>) – analytical uncertainty on x at <span class="math notranslate nohighlight">\(1\sigma\)</span> abs.</p></li>
<li><p><strong>y</strong> (<em>np.ndarray</em>) – y values</p></li>
<li><p><strong>sy</strong> (<em>np.ndaray</em>) – analytical uncertainty on y at <span class="math notranslate nohighlight">\(1\sigma\)</span> abs.</p></li>
<li><p><strong>r_xy</strong> (<em>np.ndarray</em>) – x-y correlation coefficient</p></li>
<li><p><strong>model</strong> (<em>str</em><em>, </em><em>optional</em>) – Regression model to fit to data.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>model should be one of</p>
<ul class="simple">
<li><p><strong>ra</strong> fit ‘best’ robust model depending on whether or no spine width is less than slim</p></li>
<li><p><strong>rs</strong> spine fit of Powell et al. (2020)</p></li>
<li><p><strong>r2</strong> robust model 2, a robust version of the Isoplot model 2</p></li>
<li><p><strong>rx</strong> spine fit with expanded errors, for use if s is a little bit over slim (experimental feature only)</p></li>
</ul>
<p>Data should be input as 1-dimensional ndarrays.</p>
<section id="id16">
<h3>References<a class="headerlink" href="#id16" title="Permalink to this heading"></a></h3>
<p>Powell, R., Green, E.C.R., Marillo Sialer, E., Woodhead, J., 2020. Robust
isochron calculation. Geochronology 2, 325–342.
<a class="reference external" href="https://doi.org/10.5194/gchron-2-325-2020">https://doi.org/10.5194/gchron-2-325-2020</a></p>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.regression.robust_model_2">
<span class="sig-prename descclassname"><span class="pre">pysoplot.regression.</span></span><span class="sig-name descname"><span class="pre">robust_model_2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xy_err</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">disp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.regression.robust_model_2" title="Permalink to this definition"></a></dt>
<dd><p>Fit a robust model 2 linear regression to 2-dimensional data.</p>
<p>Analytical errors discarded and takes the geometric mean slope of the spine
y on x fit, and the reciprocal of the spine x on y fit, using data scatter
in place of analytical weights. Similar to the Isoplot model 2 approach
but with robust properties.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>np.ndarray</em>) – x values (as 1-dimensional array)</p></li>
<li><p><strong>y</strong> (<em>np.ndarray</em>) – y values</p></li>
<li><p><strong>xy_err</strong> (<em>np.ndarray</em><em>, </em><em>optional</em>) – 3 by n array with elements sx, sy, r_xy (i.e. analytical errors on x
and y, and their correlation coefficient)</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>If xy_err is provided, nmad of the residuals will be checked against the
median analytical uncertainty, and if larger, this value will be used to
weight data points instead. Following Powell et al. (2002), this is to
guard against a situation in which the scatter on the data is smaller than
that expected with the analytical uncertainties.</p>
<p>Code by Roger Powell with style modifications by TP.</p>
<p class="rubric">References</p>
<p>Powell, R., Hergt, J., Woodhead, J., 2002. Improving isochron calculations
with robust statistics and the bootstrap. Chemical Geology 191–204.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.regression.siegel">
<span class="sig-prename descclassname"><span class="pre">pysoplot.regression.</span></span><span class="sig-name descname"><span class="pre">siegel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.regression.siegel" title="Permalink to this definition"></a></dt>
<dd><p>Median of pairwise median slopes algorithm of Siegel (1982).</p>
<p>Based on code by Roger Powell.</p>
<p class="rubric">References</p>
<p>Siegel, A. F.: Robust regression Using repeated medians, Biometrika,
69, 242–244, 1982.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.regression.slim">
<span class="sig-prename descclassname"><span class="pre">pysoplot.regression.</span></span><span class="sig-name descname"><span class="pre">slim</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.regression.slim" title="Permalink to this definition"></a></dt>
<dd><p>Upper bound of 95% confidence interval on s (spine width) for Spine
linear regression algorithm. Derived from simulation of Gaussian distributed
datasets. See Powell et al., (2020).</p>
<p class="rubric">References</p>
<p>Powell, R., Green, E.C.R., Marillo Sialer, E., Woodhead, J., 2020. Robust
isochron calculation. Geochronology 2, 325–342.
<a class="reference external" href="https://doi.org/10.5194/gchron-2-325-2020">https://doi.org/10.5194/gchron-2-325-2020</a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.regression.spine">
<span class="sig-prename descclassname"><span class="pre">pysoplot.regression.</span></span><span class="sig-name descname"><span class="pre">spine</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rxy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.4</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.regression.spine" title="Permalink to this definition"></a></dt>
<dd><p>Iteratively re-weighted Huber line-fitting algorithm of Powell et al.
(2020).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>np.ndarray</em>) – x values (as 1-dimensional array)</p></li>
<li><p><strong>sx</strong> (<em>np.ndarray</em>) – analytical uncertainty on x at <span class="math notranslate nohighlight">\(1\sigma\)</span> abs.</p></li>
<li><p><strong>y</strong> (<em>np.ndarray</em>) – y values</p></li>
<li><p><strong>sy</strong> (<em>np.ndaray</em>) – analytical uncertainty on y at <span class="math notranslate nohighlight">\(1\sigma\)</span> abs.</p></li>
<li><p><strong>rxy</strong> (<em>np.ndarray</em>) – x-y correlation coefficient</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Updated to use normalised deltheta as convergence criteria for improved
performance where slope and y-int are of very different order of
magnitude.</p>
<p>Code by Roger Powell with style modifications by TP.</p>
<p class="rubric">References</p>
<p>Powell, R., Green, E.C.R., Marillo Sialer, E., Woodhead, J., 2020. Robust
isochron calculation. Geochronology 2, 325–342.
<a class="reference external" href="https://doi.org/10.5194/gchron-2-325-2020">https://doi.org/10.5194/gchron-2-325-2020</a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.regression.york">
<span class="sig-prename descclassname"><span class="pre">pysoplot.regression.</span></span><span class="sig-name descname"><span class="pre">york</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_xy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sy_excess</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'1'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">itmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rtol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-08</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-08</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.regression.york" title="Permalink to this definition"></a></dt>
<dd><p>Fit total weighted least squares regression using the algorithm
of York (2004). Analytical errors on regression
parameters are equivalent to the Maximum Likelihood approach of
Titterington and Halliday (1979).</p>
<p>Can also fit a version of the Isoplot model 2 and model 3 (but see note)
by adjusting th weightings. Model 2 code is based on McSaveney in Faure (1977).
Model 3 code emulates Isoplot (Ludwig, 2012).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>np.ndarray</em><em>, </em><em>1-D</em>) – x values</p></li>
<li><p><strong>sx</strong> (<em>np.ndarray</em><em>, </em><em>1-D</em>) – analytical uncertainty on x at <span class="math notranslate nohighlight">\(1\sigma\)</span> abs.</p></li>
<li><p><strong>y</strong> (<em>np.ndarray</em><em>, </em><em>1-D</em>) – y values</p></li>
<li><p><strong>sy</strong> (<em>np.ndaray</em><em>, </em><em>1-D</em>) – analytical uncertainty on y at <span class="math notranslate nohighlight">\(1\sigma\)</span> abs.</p></li>
<li><p><strong>r_xy</strong> (<em>np.ndarray</em><em>, </em><em>1-D</em>) – x-y correlation coefficient</p></li>
<li><p><strong>model</strong> (<em>{'1'</em><em>, </em><em>'2'</em><em>, </em><em>'3'}</em><em>, </em><em>optional</em>) – model type to fit</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Model 3 fits involve an iterative approach that typically requires calling
this function several times. To perform a model 3 fit, call
<a class="reference internal" href="#pysoplot.regression.model_3" title="pysoplot.regression.model_3"><code class="xref py py-func docutils literal notranslate"><span class="pre">pysoplot.regression.model_3()</span></code></a> instead.</p>
<section id="id17">
<h3>References<a class="headerlink" href="#id17" title="Permalink to this heading"></a></h3>
<p>Faure, G., 1977. Appendix 1: Fitting of isochrons for dating by the Rb-Sr
method, in: Principles of Isotope Geology. John Wiley and Sons, pp. 1–17.</p>
<p>Ludwig, K.R., 2012. Isoplot/Ex Version 3.75: A
Geochronological Toolkit for Microsoft Excel, Special Publication 4.
Berkeley Geochronology Center.</p>
<p>Titterington, D.M., Halliday, A.N., 1979. On the fitting of parallel
isochrons and the method of maximum likelihood. Chemical Geology 26, 183–195.</p>
<p>York, D., Evensen, N.M., Martinez, M.L., De Basabe Delgado, J., 2004. Unified
equations for the slope, intercept, and standard errors of the best
straight line. American Journal of Physics 72, 367–375.
<a class="reference external" href="https://doi.org/10.1119/1.1632486">https://doi.org/10.1119/1.1632486</a></p>
</section>
</dd></dl>

</section>
<section id="module-pysoplot.stats">
<span id="pysoplot-stats-module"></span><h2>pysoplot.stats module<a class="headerlink" href="#module-pysoplot.stats" title="Permalink to this heading"></a></h2>
<p>Basic stats functions.</p>
<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.stats.mswd_conf_limits">
<span class="sig-prename descclassname"><span class="pre">pysoplot.stats.</span></span><span class="sig-name descname"><span class="pre">mswd_conf_limits</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.95</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">two_tailed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.stats.mswd_conf_limits" title="Permalink to this definition"></a></dt>
<dd><p>Returns confidence limits on MSWD for given df.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.stats.nmad">
<span class="sig-prename descclassname"><span class="pre">pysoplot.stats.</span></span><span class="sig-name descname"><span class="pre">nmad</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.stats.nmad" title="Permalink to this definition"></a></dt>
<dd><p>Median absolute deviation about the median (MAD) normalised such that
statistic will be equal to the standard deviation for a standard normal
random variable.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.stats.pr_fit">
<span class="sig-prename descclassname"><span class="pre">pysoplot.stats.</span></span><span class="sig-name descname"><span class="pre">pr_fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mswd</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.stats.pr_fit" title="Permalink to this definition"></a></dt>
<dd><p>Compute probability of fit following Ludwig (2012).</p>
<p class="rubric">References</p>
<p>Ludwig, K.R., 2012. Isoplot/Ex Version 3.75: A Geochronological Toolkit for
Microsoft Excel, Special Publication 4. Berkeley Geochronology Center.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.stats.t_critical">
<span class="sig-prename descclassname"><span class="pre">pysoplot.stats.</span></span><span class="sig-name descname"><span class="pre">t_critical</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.05</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.stats.t_critical" title="Permalink to this definition"></a></dt>
<dd><p>Critical Student’s t value for df degrees of freedom.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.stats.two_sample_p">
<span class="sig-prename descclassname"><span class="pre">pysoplot.stats.</span></span><span class="sig-name descname"><span class="pre">two_sample_p</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ox</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">oy</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.stats.two_sample_p" title="Permalink to this definition"></a></dt>
<dd><p>Return p value for test that two measurements with <strong>Gaussian</strong> distributed
uncertainties and known sigma are the same. I.e. is x - y compatible with
0 given uncertainties?</p>
</dd></dl>

</section>
<section id="module-pysoplot.transform">
<span id="pysoplot-transform-module"></span><h2>pysoplot.transform module<a class="headerlink" href="#module-pysoplot.transform" title="Permalink to this heading"></a></h2>
<p>Transform data points, regression fits, etc.</p>
<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.transform.dp_errors">
<span class="sig-prename descclassname"><span class="pre">pysoplot.transform.</span></span><span class="sig-name descname"><span class="pre">dp_errors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_error_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">append_corr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">row_wise</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-10</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.transform.dp_errors" title="Permalink to this definition"></a></dt>
<dd><p>Convert data point uncertainties to 1 <span class="math notranslate nohighlight">\(\sigma\)</span> absolute.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_error_type</strong> (<em>str</em>) – Error type and sigma level, use: {abs/per/rel}{1s/2s}</p></li>
<li><p><strong>append_corr</strong> (<em>bool</em><em>, </em><em>optional</em>) – Assume error correlations are zero by appending a column of zeros to the end
of n x 4 data point array.</p></li>
<li><p><strong>row_wise</strong> (<em>bool</em><em>, </em><em>optional</em>) – True if each row is a data point and each column is a variable. False if
vice versa.</p></li>
<li><p><strong>dim</strong> (<em>int</em>) – 1 for univariate data (e.g. Pb*/U data), 2 for multivariate (2-D) data.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.transform.transform_centroid">
<span class="sig-prename descclassname"><span class="pre">pysoplot.transform.</span></span><span class="sig-name descname"><span class="pre">transform_centroid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xbar</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ybar</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transform_to</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'wc'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.transform.transform_centroid" title="Permalink to this definition"></a></dt>
<dd><p>Transform x-bar and y-bar for classical regression fit from Terra-Wasserburg
to Wetheril or vice versa.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.transform.transform_covtheta">
<span class="sig-prename descclassname"><span class="pre">pysoplot.transform.</span></span><span class="sig-name descname"><span class="pre">transform_covtheta</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">theta0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">covtheta0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transform_to</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'wc'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.transform.transform_covtheta" title="Permalink to this definition"></a></dt>
<dd><p>Transform regression fit covtheta from Tera-Wasserburg coordinates to
Wetheril (conventional discordia) coordinates or vice versa.
See, e.g., Ludwig (2000).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>theta0</strong> (<em>array-like</em><em>, </em><em>1-D</em>) – Linear regression y-intercept and slope parameters.</p></li>
<li><p><strong>covtheta0</strong> (<em>np.ndarray</em><em>, </em><em>2 x 2</em>) – Covariance matrix of regression fit parameters.</p></li>
<li><p><strong>transform_to</strong> (<em>{'wc'</em><em>, </em><em>'tw'}</em><em>, </em><em>optional</em>) – Diagram coordinates to output.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">References</p>
<p>Ludwig, K.R., 2000. Decay constant errors in U–Pb concordia-intercept ages.
Chemical Geology 166, 315–318.
<a class="reference external" href="https://doi.org/10.1016/S0009-2541(99)00219-3">https://doi.org/10.1016/S0009-2541(99)00219-3</a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.transform.transform_dp">
<span class="sig-prename descclassname"><span class="pre">pysoplot.transform.</span></span><span class="sig-name descname"><span class="pre">transform_dp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ox0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">oy0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_xy0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">to</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'wc'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.transform.transform_dp" title="Permalink to this definition"></a></dt>
<dd><p>Transform concordia diagram data points from Tera-Wasserburg to Wetheril
concordia or vice versa.</p>
<p class="rubric">Notes</p>
<p>E.g., see Ludwig (1998) and Noda (2017).</p>
<p class="rubric">References</p>
<p>Ludwig, K.R., 1998. On the treatment of concordant uranium-lead ages.
Geochimica et Cosmochimica Acta 62, 665–676.
<a class="reference external" href="https://doi.org/10.1016/S0016-7037(98)00059-3">https://doi.org/10.1016/S0016-7037(98)00059-3</a></p>
<p>Noda, A., 2017. A new tool for calculation and visualization of U.
Bulletin of the Geological Survey of Japan 1–10.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.transform.transform_fit">
<span class="sig-prename descclassname"><span class="pre">pysoplot.transform.</span></span><span class="sig-name descname"><span class="pre">transform_fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fit</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transform_to</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'wc'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.transform.transform_fit" title="Permalink to this definition"></a></dt>
<dd><p>Transform regression theta and covtheta from Tera-Wasserburg
coordinates to Wetheril coordinates (or vice versa)
in one go.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fit</strong> (<em>dict</em>) – Regression fit parameters.</p></li>
<li><p><strong>transform_to</strong> (<em>{'wc'</em><em>, </em><em>'tw'}</em><em>, </em><em>optional</em>) – Diagram coordinates to output.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.transform.transform_theta">
<span class="sig-prename descclassname"><span class="pre">pysoplot.transform.</span></span><span class="sig-name descname"><span class="pre">transform_theta</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">theta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transform_to</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'wc'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.transform.transform_theta" title="Permalink to this definition"></a></dt>
<dd><p>Transform theta from Tera-Wasserburg (tw) coordinates to Wetheril
(conventional concordia, wc) coordinates or vice versa.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>theta</strong> (<em>array-like</em><em>, </em><em>1-D</em>) – Linear regression y-intercept and slope values.</p></li>
<li><p><strong>transform_to</strong> (<em>{'wc'</em><em>, </em><em>'tw'}</em><em>, </em><em>optional</em>) – Diagram coordinates to output.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-pysoplot.upb">
<span id="pysoplot-upb-module"></span><h2>pysoplot.upb module<a class="headerlink" href="#module-pysoplot.upb" title="Permalink to this heading"></a></h2>
<p>Functions and routines for U-Pb geochronology.</p>
<p class="rubric">Notes</p>
<p>See <a class="reference internal" href="#module-pysoplot.dqpb" title="pysoplot.dqpb"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pysoplot.dqpb</span></code></a> for equivalent functions that account for
disequilibrium in the uranium-series decay chains.</p>
<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.upb.concint_age">
<span class="sig-prename descclassname"><span class="pre">pysoplot.upb.</span></span><span class="sig-name descname"><span class="pre">concint_age</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fit</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'L1980'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diagram</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'tw'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dc_errors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.upb.concint_age" title="Permalink to this definition"></a></dt>
<dd><p>Compute concordia-intercept age and uncertainty using various algorithms.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fit</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">dict</span></code>) – Regression fit parameters.</p></li>
<li><p><strong>method</strong> (<em>{'Powell'</em><em>, </em><em>'L1980'</em><em>, </em><em>'L2000'}</em><em>, </em><em>optional</em>) – Algorithm used to compute age and age uncertainties.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>results</strong> – Age results.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>The ‘Powell’ method focuses on lower intercept age only (&lt; ~1 Ga),
but works with all fit types. Age uncertainties are symmetric.</p></li>
<li><p>The ‘L1980’ method only works with classical fits. Age uncertainties
are asymmetric.</p></li>
<li><p>The ‘L2000’ method works with all fit types and optionally accounts           for decay constant errors, but requires 2 intercept age solutions.</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.upb.concint_age_min">
<span class="sig-prename descclassname"><span class="pre">pysoplot.upb.</span></span><span class="sig-name descname"><span class="pre">concint_age_min</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">diagram</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'tw'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.upb.concint_age_min" title="Permalink to this definition"></a></dt>
<dd><p>Concordia-intercept age minimisation functions for Monte Carlo
simulation.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.upb.concint_ludwig">
<span class="sig-prename descclassname"><span class="pre">pysoplot.upb.</span></span><span class="sig-name descname"><span class="pre">concint_ludwig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">theta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diagram</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'tw'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxiter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">40</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.upb.concint_ludwig" title="Permalink to this definition"></a></dt>
<dd><p>Compute concordia-intercept age using routine in the appendix of Ludwig
(1980).</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.upb.concint_powell">
<span class="sig-prename descclassname"><span class="pre">pysoplot.upb.</span></span><span class="sig-name descname"><span class="pre">concint_powell</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">theta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">covtheta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uncert</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxiter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">30</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diagram</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'tw'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.upb.concint_powell" title="Permalink to this definition"></a></dt>
<dd><p>Compute Tera-Wasserburg concordia intercept age and uncertainty focussing
on lower intercept only using the method of Powell et al. (2020). Converges
rapidly, but will not work for intercept ages greater than ~100 Ma.
Does not account for decay constant errors.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.upb.concint_uncert_ludwig1980">
<span class="sig-prename descclassname"><span class="pre">pysoplot.upb.</span></span><span class="sig-name descname"><span class="pre">concint_uncert_ludwig1980</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta_95ci</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xbar</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diagram</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'wc'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxiter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">40</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.upb.concint_uncert_ludwig1980" title="Permalink to this definition"></a></dt>
<dd><p>Compute concordia-intercept age uncertainties using the approach of Ludwig (1980).
The algorithm can account for asymmetric age uncertainties, but not decay
constant errors.</p>
<p class="rubric">Notes</p>
<p>This algorithm requires x-bar to be specified so it is really only suitable
for use with classical regression lines.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.upb.concint_uncert_ludwig2000">
<span class="sig-prename descclassname"><span class="pre">pysoplot.upb.</span></span><span class="sig-name descname"><span class="pre">concint_uncert_ludwig2000</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">covtheta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_mult</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dc_errors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.upb.concint_uncert_ludwig2000" title="Permalink to this definition"></a></dt>
<dd><p>Compute lower and upper concordia intercept age and uncertainties in one
go based on equations in Ludwig (2000). Can account for decay constant
errors. Assumes age uncertainties are symmetric.</p>
<p>Equations require data points to be in Wetheril concordia form. A
transformation should first be performed if data points are in
Tera-Wasserburg form.</p>
<p class="rubric">Notes</p>
<p>Ludwig (2000) uses ‘m’ for regression line slope and ‘b’ for regression
line y-int, whereas this function uses ‘b’ for regression line slope and
‘a’ for y-intercept.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.upb.isochron_age">
<span class="sig-prename descclassname"><span class="pre">pysoplot.upb.</span></span><span class="sig-name descname"><span class="pre">isochron_age</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fit</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">age_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'iso-206Pb'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dc_errors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_isotope</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'204Pb'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.upb.isochron_age" title="Permalink to this definition"></a></dt>
<dd><p>Classical U-Pb isochron age and uncertainty.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fit</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">dict</span></code>) – Regression fit parameters.</p></li>
<li><p><strong>age_type</strong> (<em>{'iso-206Pb'</em><em>, </em><em>'iso-207Pb'}</em><em>, </em><em>optional</em>) – Isochron type.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>results</strong> – Age results.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.upb.mc_concint">
<span class="sig-prename descclassname"><span class="pre">pysoplot.upb.</span></span><span class="sig-name descname"><span class="pre">mc_concint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fit</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trials</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diagram</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'tw'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dc_errors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">U_errors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intercept_plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hist</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(None,</span> <span class="pre">None)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(None,</span> <span class="pre">None)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">env</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">age_ellipses</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">marker_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">marker_ages</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">()</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">auto_marker_ages</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_overlaps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intercept_points</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intercept_ellipse</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">negative_ages</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">age_prefix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Ma'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.upb.mc_concint" title="Permalink to this definition"></a></dt>
<dd><p>Compute Monte Carlo age uncertainties for equilibrium concordia intercept
age.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t</strong> (<em>float</em>) – Calculated age (Ma).</p></li>
<li><p><strong>fit</strong> (<em>dict</em>) – Linear regression fit parameters.</p></li>
<li><p><strong>trials</strong> (<em>int</em>) – Number of Monte Carlo trials.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.upb.mc_pbu">
<span class="sig-prename descclassname"><span class="pre">pysoplot.upb.</span></span><span class="sig-name descname"><span class="pre">mc_pbu</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.upb.mc_pbu" title="Permalink to this definition"></a></dt>
<dd><p>Not yet coded.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.upb.pbu_age">
<span class="sig-prename descclassname"><span class="pre">pysoplot.upb.</span></span><span class="sig-name descname"><span class="pre">pbu_age</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">age_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'206Pb*'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dc_errors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.upb.pbu_age" title="Permalink to this definition"></a></dt>
<dd><p>Single analysis Pb/U age.</p>
<p class="rubric">Notes</p>
<p>Uncertainties in a suite of single-analysis Pb/U ages should be
propagated by quadratic addition after taking the weighted mean (e.g.,
Horstwood, 2016).</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.upb.pbu_ages">
<span class="sig-prename descclassname"><span class="pre">pysoplot.upb.</span></span><span class="sig-name descname"><span class="pre">pbu_ages</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">age_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'206Pb*'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cov</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wav</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.upb.pbu_ages" title="Permalink to this definition"></a></dt>
<dd><p>Pb/U ages and uncertainty.
!!! Not yet fully coded !!!</p>
</dd></dl>

</section>
<section id="module-pysoplot.useries">
<span id="pysoplot-useries-module"></span><h2>pysoplot.useries module<a class="headerlink" href="#module-pysoplot.useries" title="Permalink to this heading"></a></h2>
<p>Uranium-series functions and routines.</p>
<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.useries.Th230_age">
<span class="sig-prename descclassname"><span class="pre">pysoplot.useries.</span></span><span class="sig-name descname"><span class="pre">Th230_age</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.useries.Th230_age" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.useries.Th230_age_uncert">
<span class="sig-prename descclassname"><span class="pre">pysoplot.useries.</span></span><span class="sig-name descname"><span class="pre">Th230_age_uncert</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.useries.Th230_age_uncert" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.useries.Th230_isochron">
<span class="sig-prename descclassname"><span class="pre">pysoplot.useries.</span></span><span class="sig-name descname"><span class="pre">Th230_isochron</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.useries.Th230_isochron" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.useries.ar08">
<span class="sig-prename descclassname"><span class="pre">pysoplot.useries.</span></span><span class="sig-name descname"><span class="pre">ar08</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a234_238</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a230_238_i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lam238</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lam234</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lam230</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.useries.ar08" title="Permalink to this definition"></a></dt>
<dd><p>Calculate present [230Th/238U] as a function of present ratio and
time.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>init</strong> (<em>bool</em>) – True if <cite>a234_238</cite> is as an initial activity ratio.</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Secular equilibrium equations are given by, e.g., Cheng et al. (2000) and
Hellstrom (2006).</p>
<p>Non-secular equilibrium equation is derived from Bateman (1910) and does
not assume negligible decay of 238U (e.g., Ivanovich and Harmon
(1992)). This is an experimental feature.</p>
<p class="rubric">References</p>
<p>Cheng, H., Adkins, J., Edwards, R.L., Boyle, E.A., 2000.
U-Th dating of deep-sea corals. Geochimica et Cosmochimica Acta 64, 2401–2416.
<a class="reference external" href="https://doi.org/10.1016/S0016-7037(99)00422-6">https://doi.org/10.1016/S0016-7037(99)00422-6</a></p>
<p>Hellstrom, J., 2006. U–Th dating of speleothems with
high initial 230Th using stratigraphical constraint. Quaternary
Geochronology 1, 289–295. <a class="reference external" href="https://doi.org/10.1016/j.quageo.2007.01.004">https://doi.org/10.1016/j.quageo.2007.01.004</a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.useries.ar08i">
<span class="sig-prename descclassname"><span class="pre">pysoplot.useries.</span></span><span class="sig-name descname"><span class="pre">ar08i</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a234_238</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a230_238</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lam238</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lam234</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lam230</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.useries.ar08i" title="Permalink to this definition"></a></dt>
<dd><p>Calculate initial [230Th/238U] as a function of present ratio and
time.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>init</strong> (<em>bool</em>) – True if <cite>a234_238</cite> is as an initial activity ratio.</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Secular equilibrium equations are given by, e.g., Cheng et al., (2000) and
Hellstrom (2006).</p>
<p>Non-secular equilibrium equation is derived from Bateman (1910) and does
not assume negligible decay of 238U (e.g., Ivanovich and Harmon
(1992)). This is an experimental feature.</p>
<p class="rubric">References</p>
<p>Cheng, H., Adkins, J., Edwards, R.L., Boyle, E.A., 2000.
U-Th dating of deep-sea corals. Geochimica et Cosmochimica Acta 64, 2401–2416.
<a class="reference external" href="https://doi.org/10.1016/S0016-7037(99)00422-6">https://doi.org/10.1016/S0016-7037(99)00422-6</a></p>
<p>Hellstrom, J., 2006. U–Th dating of speleothems with
high initial 230Th using stratigraphical constraint. Quaternary
Geochronology 1, 289–295. <a class="reference external" href="https://doi.org/10.1016/j.quageo.2007.01.004">https://doi.org/10.1016/j.quageo.2007.01.004</a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.useries.ar48">
<span class="sig-prename descclassname"><span class="pre">pysoplot.useries.</span></span><span class="sig-name descname"><span class="pre">ar48</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a234_238_i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lam238</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lam234</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.useries.ar48" title="Permalink to this definition"></a></dt>
<dd><p>Calculate initial [234U/238U] activity ratio as a function of initial
ratio and age (Ma).</p>
<p class="rubric">Notes</p>
<p>Non-secular equilibrium equation is derived from Bateman (1910) and does
not assume negligible decay of 238U (e.g., Ivanovich and Harmon
(1992)). This is an experimental feature.</p>
<p class="rubric">References</p>
<p>Ivanovich, M. and Harmon, R. S.: Uranium-Series Disequilibrium:
Applications to Earth, Marine, and Environmental Sciences., Clarendon
Press, United Kingdom, second edn., 1992.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.useries.ar48i">
<span class="sig-prename descclassname"><span class="pre">pysoplot.useries.</span></span><span class="sig-name descname"><span class="pre">ar48i</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a234_238</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lam238</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lam234</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.useries.ar48i" title="Permalink to this definition"></a></dt>
<dd><p>Calculate initial [234U/238U] activity ratio as a function of present
ratio and age (Ma).</p>
<p class="rubric">Notes</p>
<p>Non-secular equilibrium equation is derived from Bateman (1910) and does
not assume negligible decay of 238U (e.g., Ivanovich and Harmon
(1992)). This is an experimental feature.</p>
<p class="rubric">References</p>
<p>Ivanovich, M. and Harmon, R. S.: Uranium-Series Disequilibrium:
Applications to Earth, Marine, and Environmental Sciences., Clarendon
Press, United Kingdom, second edn., 1992.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.useries.init_ratio_solutions">
<span class="sig-prename descclassname"><span class="pre">pysoplot.useries.</span></span><span class="sig-name descname"><span class="pre">init_ratio_solutions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Lam</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.useries.init_ratio_solutions" title="Permalink to this definition"></a></dt>
<dd><p>Compute initial activity ratio solutions from present-day values and U-Pb age
solution. In principle these values are computed iteratively along with the
age solution, but practically it is more convenient to compute them separately</p>
</dd></dl>

</section>
<section id="module-pysoplot.wendt_carl">
<span id="pysoplot-wendt-carl-module"></span><h2>pysoplot.wendt_carl module<a class="headerlink" href="#module-pysoplot.wendt_carl" title="Permalink to this heading"></a></h2>
<p>Disequlibrium Pb/U functions based on Wendt and Carl (1985).</p>
<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.wendt_carl.f">
<span class="sig-prename descclassname"><span class="pre">pysoplot.wendt_carl.</span></span><span class="sig-name descname"><span class="pre">f</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">DC</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(True,</span> <span class="pre">True)</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.wendt_carl.f" title="Permalink to this definition"></a></dt>
<dd><p>206Pb/236U atomic ratio as a function of time and actvitiy
ratios using equation from <a class="reference internal" href="#id20" id="id18"><span>[Wendt1985]</span></a>.</p>
<p class="rubric">References</p>
<dl class="citation">
<dt class="label" id="wendt1985"><span class="brackets">Wendt1985</span></dt>
<dd><p>Wendt, I., Carl, C., 1985. U/Pb dating of discordant 0.1
Ma old secondary U minerals. Earth and Planetary Science Letters 73, 278–284.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.wendt_carl.g">
<span class="sig-prename descclassname"><span class="pre">pysoplot.wendt_carl.</span></span><span class="sig-name descname"><span class="pre">g</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">A15i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">DC</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.wendt_carl.g" title="Permalink to this definition"></a></dt>
<dd><p>207Pb/235U atomic ratio as a function of time and actvitiy
ratios using equation from <a class="reference internal" href="#id20" id="id19"><span>[Wendt1985]</span></a>.</p>
<p class="rubric">References</p>
<dl class="citation">
<dt class="label" id="id20"><span class="brackets">Wendt1985</span></dt>
<dd><p>Wendt, I., Carl, C., 1985. U/Pb dating of discordant 0.1
Ma old secondary U minerals. Earth and Planetary Science Letters 73, 278–284.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-pysoplot.wtd_average">
<span id="pysoplot-wtd-average-module"></span><h2>pysoplot.wtd_average module<a class="headerlink" href="#module-pysoplot.wtd_average" title="Permalink to this heading"></a></h2>
<p>Weighted average algorithms for 1- and 2-dimensional data</p>
<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.wtd_average.classical_wav">
<span class="sig-prename descclassname"><span class="pre">pysoplot.wtd_average.</span></span><span class="sig-name descname"><span class="pre">classical_wav</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">V</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ca'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.wtd_average.classical_wav" title="Permalink to this definition"></a></dt>
<dd><p>Compute a classical 1-dimensional weighted average accounting for assigned
uncertainties (and optionally uncertainty correlations).</p>
<p>Partly emulates the behaviour of Isoplot Ludwig (2012). If one-sided MSWD
confidence limit is above lower threshold, uncertainty on weighted average is expanded
according to data scatter (i.e., by sqrt(mswd)).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sx</strong> (<em>np.ndarray</em><em>, </em><em>optional</em>) – Analytical uncertainties at the 1 sigma level.</p></li>
<li><p><strong>V</strong> (<em>np.ndarray</em><em>, </em><em>optional</em>) – Uncertainty covariance matrix.</p></li>
<li><p><strong>method</strong> (<em>{'ca'}</em>) – Weighted average method to use (only one available currently)</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Does not yet include external error component if MSWD confidence limit is
above an upper threshold (as in the Isoplot MLE approach), although this
feature may be added in future.</p>
<section id="id21">
<h3>References<a class="headerlink" href="#id21" title="Permalink to this heading"></a></h3>
<p>Ludwig, K.R., 2012. Isoplot/Ex Version 3.75: A Geochronological Toolkit for
Microsoft Excel, Special Publication 4. Berkeley Geochronology Center.</p>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.wtd_average.robust_wav">
<span class="sig-prename descclassname"><span class="pre">pysoplot.wtd_average.</span></span><span class="sig-name descname"><span class="pre">robust_wav</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">V</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ra'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.wtd_average.robust_wav" title="Permalink to this definition"></a></dt>
<dd><p>Compute a robust 1-dimensional weighted average accounting for
assigned uncertainties (and optionally uncertainty correlations).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>np.ndarray</em>) – Data points to average (as 1-d array).</p></li>
<li><p><strong>sx</strong> (<em>np.ndarray</em><em>, </em><em>optional</em>) – Analytical uncertainties at the 1 sigma level (as 1-d array).</p></li>
<li><p><strong>V</strong> (<em>np.ndarray</em><em>, </em><em>optional</em>) – Uncertainty covariance matrix.</p></li>
<li><p><strong>method</strong> (<em>{'ra'}</em>) – Weighted average method to use (only one available currently)</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Only implements spine robust weighted average at present.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.wtd_average.slim_wav">
<span class="sig-prename descclassname"><span class="pre">pysoplot.wtd_average.</span></span><span class="sig-name descname"><span class="pre">slim_wav</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.wtd_average.slim_wav" title="Permalink to this definition"></a></dt>
<dd><p>Returns Upper 95% confidence limit on spine width (s) for weighted averages.
Values are derived via simulation of Gaussian distributed datasets.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.wtd_average.spine_wav">
<span class="sig-prename descclassname"><span class="pre">pysoplot.wtd_average.</span></span><span class="sig-name descname"><span class="pre">spine_wav</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xb0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxiter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.4</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.wtd_average.spine_wav" title="Permalink to this definition"></a></dt>
<dd><p>Compute a 1-dimensional robust uncertainty weighted average using the spine
algorithm, <strong>without</strong> accounting for error covariance.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.wtd_average.spine_wav_cor">
<span class="sig-prename descclassname"><span class="pre">pysoplot.wtd_average.</span></span><span class="sig-name descname"><span class="pre">spine_wav_cor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">V</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xb0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxiter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-08</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rtol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-08</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.wtd_average.spine_wav_cor" title="Permalink to this definition"></a></dt>
<dd><p>Compute a spine robust uncertainty weighted average accounting for
uncertainty correlations amongst data points. Equivalent to a 1-dimensional
version of the spine linear regression algorithm of Powell et al. (2020).
Note, this reduces to classical statistics uncertainty weighted average for “well-behaved”
datasets.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>np.ndarray</em>) – Data points to be averaged (1-dimensional array).</p></li>
<li><p><strong>V</strong> (<em>np.ndarray</em>) – covariance matrix (2-dimensional array).</p></li>
</ul>
</dd>
</dl>
<p class="rubric">References</p>
<p>Powell, R., Green, E.C.R., Marillo Sialer, E., Woodhead, J., 2020. Robust
isochron calculation. Geochronology 2, 325–342.
<a class="reference external" href="https://doi.org/10.5194/gchron-2-325-2020">https://doi.org/10.5194/gchron-2-325-2020</a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.wtd_average.wav">
<span class="sig-prename descclassname"><span class="pre">pysoplot.wtd_average.</span></span><span class="sig-name descname"><span class="pre">wav</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sx</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.wtd_average.wav" title="Permalink to this definition"></a></dt>
<dd><p>Compute a 1-dimensional uncertainty weighted mean <strong>without</strong> accounting for
uncertainty covariances.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.wtd_average.wav_cor">
<span class="sig-prename descclassname"><span class="pre">pysoplot.wtd_average.</span></span><span class="sig-name descname"><span class="pre">wav_cor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">V</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.wtd_average.wav_cor" title="Permalink to this definition"></a></dt>
<dd><p>Compute a 1-dimensional uncertainty weighted mean, accounting for uncertainty
correlations amongst individual data points.</p>
<p>Based on equations given in, e.g., Powell1 and Holland (1988],
Lyons et al. (1988), and McLean et al. (2011).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>np.ndarray</em>) – Data points to be averaged (should be a 1-dimensional array).</p></li>
<li><p><strong>V</strong> (<em>np.ndarray</em>) – covariance matrix (should be a 2-dimensional array).</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>See cautionary note in Lyons et al. (1988):</p>
<blockquote>
<div><p>“One point to beware of in practice is
the situation in which the individual weights become numerically very
large.” … this happens when [errors are very close to each other and
highly correlated]. If we have slightly mis-estimated the elements of
the error matrix, or if our measurements are slightly biassed, the effect
of the large weights with different signs can be to drive our solution
far away from the correct value.”</p>
</div></blockquote>
<p class="rubric">References</p>
<p>Lyons, L., Gibaut, D., Clifford, P., 1988. How to combine correlated
estimates of a single physical quantity. Nuclear Instruments and Methods in
Physics Research Section A: Accelerators, Spectrometers, Detectors and
Associated Equipment 270, 110–117.</p>
<p>McLean, N M, J F Bowring, and S A Bowring, 2011, An Algorithm for U-Pb Isotope
Dilution Data Reduction and Uncertainty Propagation Geochemistry,
Geophysics, Geosystems 12, no. 6.
<a class="reference external" href="https://doi.org/10.1029/2010GC003478">https://doi.org/10.1029/2010GC003478</a>.</p>
<p>Powell, R., Holland, T.J.B., 1988. An internally consistent dataset with
uncertainties and correlations: 3. Applications to geobarometry, worked
examples and a computer program. J Metamorph Geol 6, 173–204.
<a class="reference external" href="https://doi.org/10.1111/j.1525-1314.1988.tb00415.x">https://doi.org/10.1111/j.1525-1314.1988.tb00415.x</a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pysoplot.wtd_average.wavx">
<span class="sig-prename descclassname"><span class="pre">pysoplot.wtd_average.</span></span><span class="sig-name descname"><span class="pre">wavx</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pysoplot.wtd_average.wavx" title="Permalink to this definition"></a></dt>
<dd><p>Classical weighted average with excess scatter parameterised as a uniform
Gaussian source of error applied equally to all datapoints.</p>
</dd></dl>

</section>
<section id="module-pysoplot">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-pysoplot" title="Permalink to this heading"></a></h2>
<p>A Python library for geochronology.</p>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Timothy Pollard.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>